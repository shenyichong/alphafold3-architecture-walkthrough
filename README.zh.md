# è¶…è¯¦ç»† AlphaFold 3 ç®—æ³•è§£æ

by Yichong Shen

> **ğŸ“§ è”ç³»æ–¹å¼**: å¦‚æœæ‚¨å¯¹æœ¬åˆ†ææœ‰ä»»ä½•é—®é¢˜ã€è®¨è®ºæˆ–åˆä½œæ„å‘ï¼Œæ¬¢è¿é€šè¿‡ä»¥ä¸‹é‚®ç®±è”ç³»ï¼šshenyichong2011@gmail.com
> 
> **â­ å¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªåˆ†æå¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·è€ƒè™‘ä¸ºæœ¬ä»“åº“ç‚¹ä¸ªstarï¼æ‚¨çš„æ”¯æŒèƒ½å¸®åŠ©æ›´å¤šäººå‘ç°è¿™ä¸ªèµ„æºã€‚**

> æœ¬æŠ€æœ¯æ·±åº¦è§£æçš„çµæ„Ÿæ¥æºäº [The Illustrated AlphaFold](https://elanapearl.github.io/blog/2024/the-illustrated-alphafold/)ã€‚ç‰¹åˆ«æ„Ÿè°¢ Elana Pearl æä¾›çš„å¯è§†åŒ–èµ„æºã€‚

**ğŸ“– é˜…è¯»è¯­è¨€ï¼š** [English](README.md) | [ä¸­æ–‡](README.zh.md)

**ğŸ’¬ è®¨è®ºï¼š** åŠ å…¥æˆ‘ä»¬çš„[Redditè®¨è®º](https://www.reddit.com/r/bioinformatics/comments/1l7xcp3/alphafold_3_demystified_i_wrote_a_technical/)ï¼Œä¸ç”Ÿç‰©ä¿¡æ¯å­¦ç¤¾åŒºä¸€èµ·è®¨è®ºè¿™ä¸ªè¯é¢˜ã€‚

---

## ğŸ“‹ ç›®å½•

<details>
<summary>ç‚¹å‡»å±•å¼€å®Œæ•´ç›®å½•</summary>

- [Input Preparation](#input-preparation)
  - [**MSAå’ŒTemplatesæ˜¯å¦‚ä½•æ¥çš„ï¼Ÿ**](#msaå’Œtemplatesæ˜¯å¦‚ä½•æ¥çš„)
    - [ä¸ºä»€ä¹ˆéœ€è¦MSAï¼Ÿ](#ä¸ºä»€ä¹ˆéœ€è¦msa)
    - [ä¸ºä»€ä¹ˆéœ€è¦Templatesï¼Ÿ](#ä¸ºä»€ä¹ˆéœ€è¦templates)
    - [å¦‚ä½•è·å–MSAï¼Ÿ](#å¦‚ä½•è·å–msa)
    - [å¦‚ä½•è·å–Templatesï¼Ÿ](#å¦‚ä½•è·å–templates)
    - [å¦‚ä½•è¡¨å¾Templatesï¼Ÿ](#å¦‚ä½•è¡¨å¾templates)
  - [**å¦‚ä½•æ„å»ºAtom-levelçš„è¡¨å¾ï¼Ÿ**](#å¦‚ä½•æ„å»ºatom-levelçš„è¡¨å¾)
    - [æ„å»ºpå’Œq](#æ„å»ºpå’Œq)
    - [æ›´æ–°qï¼ˆAtom Transformerï¼‰](#æ›´æ–°qatom-transformer)
  - [**å¦‚ä½•æ„å»ºToken-levelçš„è¡¨å¾ï¼Ÿ**](#å¦‚ä½•æ„å»ºtoken-levelçš„è¡¨å¾)
    - [Tokençº§å•åºåˆ—è¡¨å¾](#tokençº§å•åºåˆ—è¡¨å¾)
    - [Tokençº§å¯¹è¡¨å¾](#tokençº§å¯¹è¡¨å¾)
- [Representation Learning](#representation-learning)
  - [Template Module](#template-module)
  - [MSA Module](#msa-module)
  - [Pairformer Module](#pairformer-module)
- [Structure Prediction](#structure-prediction)
  - [Diffusionçš„åŸºæœ¬æ¦‚å¿µ](#diffusionçš„åŸºæœ¬æ¦‚å¿µ)
  - [Structure Prediction è¯¦è§£](#structure-prediction-è¯¦è§£)
    - [Sample Diffusionéƒ¨åˆ†è¯¦è§£ï¼ˆæ¨ç†è¿‡ç¨‹ï¼‰](#sample-diffusionéƒ¨åˆ†è¯¦è§£æ¨ç†è¿‡ç¨‹)
    - [Diffusion Moduleéƒ¨åˆ†è¯¦è§£ï¼ˆæ¨ç†è¿‡ç¨‹ï¼‰](#diffusion-moduleéƒ¨åˆ†è¯¦è§£æ¨ç†è¿‡ç¨‹)
- [Loss Function](#loss-function)
    - [$L_{distogram}$](#l_distogram)
    - [$L_{diffusion}$](#l_diffusion)
    - [$L_{confidence}$](#l_confidence)

</details>

--- 

# Input Preparation

## **MSAå’ŒTemplatesæ˜¯å¦‚ä½•æ¥çš„ï¼Ÿ**

### ä¸ºä»€ä¹ˆéœ€è¦MSAï¼Ÿ
- å­˜åœ¨äºä¸åŒç‰©ç§ä¹‹é—´ä¸åŒç‰ˆæœ¬æŸä¸€ç±»è›‹ç™½ï¼Œå…¶åºåˆ—å’Œç»“æ„å¯èƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œé€šè¿‡å°†è¿™äº›è›‹ç™½é›†åˆèµ·æ¥æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªè›‹ç™½è´¨çš„æŸäº›ä½ç½®æ˜¯å¦‚ä½•éšç€è¿›åŒ–æ”¹å˜çš„ã€‚
- MSAçš„æ¯ä¸€è¡Œä»£è¡¨æ¥è‡ªä¸åŒç‰©ç§çš„ç›¸ä¼¼è›‹ç™½ã€‚åˆ—ä¸Šçš„ä¿å®ˆæ¨¡å¼å¯ä»¥ååº”å‡ºè¯¥ä½ç½®éœ€è¦æŸäº›ç‰¹å®šæ°¨åŸºé…¸çš„é‡è¦æ€§ã€‚ä¸åŒåˆ—ä¹‹é—´çš„å…³ç³»åˆ™ååº”å‡ºæ°¨åŸºé…¸ä¹‹é—´çš„ç›¸äº’å…³ç³»ï¼ˆå¦‚æœä¸¤ä¸ªæ°¨åŸºé…¸åœ¨ç‰©ç†ä¸Šç›¸äº’ä½œç”¨ï¼Œåˆ™ä»–ä»¬åœ¨è¿›åŒ–å·¥ç¨‹ä¸­æ°¨åŸºé…¸çš„å˜åŒ–ä¹Ÿå¯èƒ½æ˜¯ç›¸å…³çš„ã€‚ï¼‰æ‰€ä»¥MSAç»å¸¸ç”¨æ¥ä¸°å¯Œå•ä¸€è›‹ç™½è´¨çš„representationã€‚

### ä¸ºä»€ä¹ˆéœ€è¦Templateï¼š

- ç±»ä¼¼çš„ï¼Œå¦‚æœä¸Šè¿°MSAä¸­åŒ…å«äº†å·²çŸ¥çš„ç»“æ„ï¼Œé‚£ä¹ˆé‚£ä¹ˆå®ƒå¾ˆæœ‰å¯èƒ½èƒ½å¤Ÿå¸®åŠ©é¢„æµ‹å½“å‰è›‹ç™½è´¨çš„ç»“æ„ã€‚Templateåªå…³å¿ƒå•é“¾çš„ç»“æ„ã€‚

### å¦‚ä½•è·å–MSAï¼Ÿ

- ä½¿ç”¨genetic searchæœç´¢ç›¸è¿‘çš„è›‹ç™½è´¨æˆ–è€…RNAé“¾ï¼Œä¸€æ¡é“¾ä¸€èˆ¬æœç´¢å‡ºN_msaï¼ˆ<16384ï¼‰æ¡ç›¸è¿‘çš„é“¾ï¼š
    
    ![image.png](images/image.png)

- å¦‚æœæ˜¯å¤šæ¡é“¾ï¼Œå¦‚æœæ¥è‡ªç›¸åŒç‰©ç§å¯ä»¥é…å¯¹ï¼ˆpairedï¼‰ï¼Œé‚£ä¹ˆMSAçš„çŸ©é˜µå¯èƒ½çš„å½¢å¼æ˜¯è¿™æ ·çš„ï¼š
        
    ![image.png](images/image%201.png)
        
- å¦åˆ™æ˜¯è¿™æ ·çš„ï¼Œæ„æˆä¸€ä¸ªdiagnoal matrixï¼š
        
    ![image.png](images/image%202.png)
        
### å¦‚ä½•è·å–Templateï¼Ÿ

- ä½¿ç”¨Template Searchï¼Œå¯¹äºç”Ÿæˆçš„MSAï¼Œä½¿ç”¨HMMå»PDBæ•°æ®åº“ä¸­å¯»æ‰¾ä¸ä¹‹ç›¸ä¼¼çš„è›‹ç™½è´¨åºåˆ—ï¼Œæ¥ä¸‹æ¥ä»è¿™äº›åŒ¹é…åˆ°çš„åºåˆ—ä¸­æŒ‘é€‰4ä¸ªæœ€é«˜è´¨é‡çš„ç»“æ„ä½œä¸ºæ¨¡ç‰ˆã€‚

### å¦‚ä½•è¡¨å¾Templatesï¼Ÿ

- è®¡ç®—æ¯ä¸€ä¸ªtokenå’Œtokenä¹‹é—´çš„æ¬§å‡ é‡Œå¾—è·ç¦»ï¼Œå¹¶ä¸”æ˜¯ç”¨ç¦»æ•£åŒ–çš„è·ç¦»è¡¨ç¤ºï¼ˆå…·ä½“æ¥è¯´ï¼Œå€¼è¢«åˆ’åˆ†ä¸º38ä¸ªåŒºé—´ï¼ŒèŒƒå›´ä»3.15Ã…åˆ°50.75Ã…ï¼Œå¤–åŠ ä¸€ä¸ªé¢å¤–çš„åŒºé—´è¡¨ç¤ºè¶…è¿‡50.75Ã…çš„è·ç¦»ï¼‰ã€‚
- å¦‚æœæŸäº›tokenåŒ…å«å¤šä¸ªåŸå­ï¼Œåˆ™é€‰æ‹©ä¸­å¿ƒåŸå­ç”¨äºè®¡ç®—è·ç¦»ï¼Œæ¯”å¦‚Â CÉ‘Â æ˜¯æ°¨åŸºé…¸çš„ä¸­å¿ƒåŸå­ï¼ŒC1æ˜¯æ ¸è‹·é…¸çš„ä¸­å¿ƒåŸå­ã€‚
- æ¨¡ç‰ˆåªåŒ…å«åŒä¸€æ¡é“¾ä¸Šçš„è·ç¦»ä¿¡æ¯ï¼Œå¿½ç•¥äº†é“¾ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚

## **å¦‚ä½•æ„å»ºAtom-levelçš„è¡¨å¾ï¼Ÿ**

- æ„å»ºå¾—åˆ°på’Œqï¼šã€å¯¹åº”Algorithm 5 AtomAttentionEncoderã€‘
    - ä¸ºäº†æ„å»ºatom-levelçš„single representationï¼Œé¦–å…ˆéœ€è¦æ‰€æœ‰çš„åŸå­å±‚é¢çš„ç‰¹å¾ï¼Œç¬¬ä¸€æ­¥æ˜¯é¦–å…ˆå¯¹æ¯ä¸€ä¸ªæ°¨åŸºé…¸ã€æ ¸è‹·é…¸ä»¥åŠligand(é…ä½“)æ„å»ºä¸€ä¸ªå‚è€ƒæ„è±¡(reference conformer)ï¼Œå‚è€ƒæ„è±¡å¯ä»¥é€šè¿‡ç‰¹å®šçš„æ–¹å¼æŸ¥å‡ºæ¥æˆ–è€…ç®—å‡ºæ¥ï¼Œä½œä¸ºå±€éƒ¨çš„å…ˆéªŒä¸‰ç»´ç»“æ„ä¿¡æ¯ã€‚
    - c å°±æ˜¯é’ˆå¯¹å‚è€ƒæ„è±¡ä¸­çš„å„ä¸ªç‰¹å¾è¿›è¡Œconcateä¹‹åï¼Œå†è¿›è¡Œä¸€æ¬¡çº¿æ€§å˜æ¢ä¹‹åçš„ç»“æœã€‚cçš„å½¢çŠ¶ä¸º[C_atom=128, N_atoms]ï¼Œå…¶ä¸­C_atomä¸ºæ¯ä¸€ä¸ªatomçº¿æ€§å˜æ¢ä¹‹åçš„ç‰¹å¾ç»´åº¦ï¼ŒN_atomsä¸ºåºåˆ—ä¸­æ‰€æœ‰åŸå­çš„ä¸ªæ•°ã€‚c_lä»£è¡¨lä½ç½®çš„åŸå­çš„ç‰¹å¾ï¼Œc_mä»£è¡¨mä½ç½®çš„åŸå­çš„ç‰¹å¾ã€‚
        
        ![image.png](images/image%203.png)
        
    - atom-levelçš„single representation qï¼Œé€šè¿‡cè¿›è¡Œåˆå§‹åŒ–ï¼š
        
        ![image.png](images/image%204.png)
        
    - ç„¶åä½¿ç”¨cæ¥åˆå§‹åŒ–atom-levelçš„åŸå­å¯¹è¡¨å¾pï¼ˆatom-level pair representationï¼‰ï¼Œpè¡¨å¾çš„æ˜¯åŸå­ä¹‹é—´çš„ç›¸å¯¹è·ç¦»ï¼Œå…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š
        1. è®¡ç®—åŸå­å‚è€ƒä¸‰ç»´åæ ‡ä¹‹é—´çš„è·ç¦»ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯ä¸€ä¸ªä¸‰ç»´çš„å‘é‡ã€‚
            
            ![image.png](images/image%205.png)
            
        2. å› ä¸ºåŸå­çš„å‚è€ƒä¸‰ç»´åæ ‡ä»…ä»…æ˜¯é’ˆå¯¹å…¶è‡ªèº«å‚è€ƒæ„è±¡å¾—åˆ°çš„ï¼Œæ˜¯ä¸€ä¸ªå±€éƒ¨ä¿¡æ¯ï¼Œæ‰€ä»¥ä»…ä»…åœ¨tokenå†…éƒ¨ï¼ˆæ°¨åŸºé…¸ã€æ ¸è‹·é…¸ã€é…ä½“ç­‰ï¼‰è®¡ç®—è·ç¦»ï¼Œæ‰€ä»¥éœ€è¦è®¡ç®—å¾—åˆ°ä¸€ä¸ªmask vï¼Œåªæœ‰ç›¸åŒchain_idå’Œresidue_idxçš„æƒ…å†µä¸‹æ‰ç›¸äº’ä¹‹é—´è®¡ç®—åæ ‡ä½ç½®å·®å¼‚ï¼Œè¿™æ—¶å€™vä¸º1ï¼Œå…¶ä»–æ—¶å€™vä¸º0
            
            ![image.png](images/image%206.png)
            
        3. è®¡ç®—pï¼Œå½¢çŠ¶ä¸º[N_atoms, N_atoms, C_atompair=16]: 
            
            ![image.png](images/image%207.png)
            
            - p(l,m) å‘é‡çš„ç»´åº¦ä¸º[C_atompair]ï¼Œè®¡ç®—æ–¹å¼ä¸ºï¼Œå¯¹d(l,m)ä¸‰ç»´å‘é‡é€šè¿‡ä¸€ä¸ªçº¿æ€§å±‚ï¼Œå¾—åˆ°ä¸€ä¸ªç»´åº¦ä¸ºC_atompairçš„å‘é‡ï¼ŒåŒæ—¶ä¹˜ä¸€ä¸ªç”¨äºmaskçš„æ ‡é‡v(l,m)ã€‚
            - inverse square of the distances 1/(1+||d(l,m)||^2)æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œç„¶åç»è¿‡ä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œå˜æˆ[C_atompair]çš„å‘é‡ï¼ŒåŒæ—¶è¿˜æ˜¯ä¹˜ä¸€ä¸ªç”¨äºmaskçš„æ ‡é‡v(l,m)ã€‚p(l,m) = p(l,m) + è¿™ä¸ªæ–°çš„å‘é‡ã€‚
            - æœ€åï¼Œp(l,m)å†åŠ ä¸Šmaskè¿™ä¸ªæ ‡é‡ã€‚
            
            ![image.png](images/image%208.png)
            
            - p(l,m) è¿˜éœ€è¦åŠ ä¸ŠåŸå§‹çš„cä¸­çš„ä¿¡æ¯ï¼ŒåŒ…å«c(:, l)çš„ä¿¡æ¯å’Œc(:, m)çš„ä¿¡æ¯ï¼Œè¿™ä¸¤ä¸ªä¿¡æ¯éƒ½å…ˆç»è¿‡reluç„¶åå†åšçº¿æ€§å˜æ¢ï¼Œå˜æ¢æˆC_atompairçš„å‘é‡ï¼ŒåŠ åˆ°p(l,m)ä¸­ã€‚
            - æœ€åp(l,m) = p(l,m) + ä¸‰å±‚MLP(p(l,m))
- æ›´æ–°qï¼ˆAtom Transformerï¼‰ï¼š
    1. Adaptive LayerNorm:ã€å¯¹åº”Algorithm 26 AdaLNã€‘
        - è¾“å…¥ä¸ºcå’Œqï¼Œå½¢çŠ¶éƒ½æ˜¯[C_atom, N_atoms]ï¼Œcä½œä¸ºæ¬¡è¦è¾“å…¥ï¼Œä¸»è¦ç”¨äºè®¡ç®—qçš„gammaå’Œbetaçš„å€¼ï¼Œè¿™æ ·é€šè¿‡cæ¥åŠ¨æ€è°ƒæ•´qçš„layerNormçš„ç»“æœã€‚
        - å…·ä½“çš„æ¥è¯´ï¼Œæ­£å¸¸çš„LayerNormæ˜¯è¿™æ ·åšçš„ï¼š
            
            ![image.png](images/image%209.png)
            
        - ç„¶åAdaptive Layer Normæ˜¯è¿™æ ·åšçš„ï¼š
            
            ![image.png](images/image%2010.png)
            
            - å…¬å¼æ˜¯è¿™æ ·çš„ï¼š
                
                ![image.png](images/image%2011.png)
                
                - è¿™é‡Œçš„aå°±æ˜¯qï¼Œså°±æ˜¯cã€‚
                - è®¡ç®—çš„æ—¶å€™sigmoid(Linear(s))ç›¸å½“äºå°±æ˜¯æ–°çš„gammaï¼ŒLinearNoBias(s)ç›¸å½“äºå°±æ˜¯æ–°çš„betaã€‚
    2. Attention with Pair Bias ã€å¯¹åº”Algorithm 24 AttentionPairBiasã€‘:
        - è¾“å…¥ä¸ºqå’Œpï¼Œqçš„å½¢çŠ¶ä¸º[C_atom, N_atoms]ï¼Œpçš„å½¢çŠ¶æ˜¯[N_atoms, N_atoms, C_atompair]ã€‚
        - ä½œä¸ºå…¸å‹çš„Attentionç»“æ„ï¼Œ(Q, K, V)éƒ½æ¥è‡ªäºqï¼Œå½¢çŠ¶ä¸º[C_atom, N_atoms]ã€‚
            - å‡è®¾æ˜¯N_headå¤´çš„attentionï¼Œå…¶ä¸­a_iä»£è¡¨qä¸­çš„ç¬¬iä¸ªåŸå­çš„å‘é‡q_i,é‚£ä¹ˆå¯¹äºç¬¬hä¸ªå¤´ï¼Œç¬¬iä¸ªqå‘é‡ï¼Œå¾—åˆ°å…¶(q_h_i, k_h_i, v_h_i):
                
                ![image.png](images/image%2012.png)
                
                - è¿™é‡Œçš„ç»´åº¦cæ˜¯è¿™æ ·å¾—åˆ°çš„ï¼š
                    
                    ![image.png](images/image%2013.png)
                    
            - Pair-biasingï¼šä»å“ªé‡Œæ¥ï¼Ÿä»pä¸­æå–ç¬¬iè¡Œï¼Œå³ç¬¬iä¸ªåŸå­å’Œå…¶ä»–åŸå­çš„å…³ç³»ï¼Œé‚£ä¹ˆp_i_jå°±æ˜¯ç¬¬iä¸ªåŸå­å’Œç¬¬jä¸ªåŸå­ä¹‹é—´çš„å…³ç³»ï¼Œå‘é‡å½¢çŠ¶ä¸º[C_atompair]ï¼Œåœ¨å…¬å¼ä¸­ä½¿ç”¨z_i_jä»£è¡¨p_i_jã€‚
                - z_i_jåœ¨C_atompairç»´åº¦ä¸Šå…ˆåšäº†ä¸€æ¬¡LayerNormï¼Œç„¶åå†åšä¸€æ¬¡çº¿æ€§å˜æ¢ï¼Œä»C_atompairç»´é™åˆ°1ç»´ï¼š
                    
                    ![image.png](images/image%2014.png)
                    
                - ç„¶åè®¡ç®—softmaxä¹‹å‰å¼•å…¥æ­¤pair Biasï¼Œæ­¤æ—¶é’ˆå¯¹ç¬¬iä¸ªåŸå­å’Œç¬¬jä¸ªåŸå­çš„å‘é‡q_h_iå’Œk_h_iå…ˆåšå‘é‡ç‚¹ä¹˜åœ¨scaleä¹‹åï¼Œå†åŠ ä¸Šä¸€ä¸ªæ ‡é‡b_h_i_jåè¿›è¡Œsoftmaxï¼Œå¾—åˆ°æƒé‡A_h_i_jï¼š
                    
                    ![image.png](images/image%2015.png)
                    
                - ç„¶åå†ç›´æ¥è®¡ç®—å¯¹äºç¬¬iä¸ªåŸå­çš„attentionç»“æœï¼š
                    
                    ![image.png](images/image%2016.png)
                    
            - Gatingï¼šä»qä¸­è·å–ç¬¬iä¸ªåŸå­çš„å‘é‡ï¼š
                - å…ˆåšä¸€æ¬¡çº¿æ€§å˜æ¢ï¼Œä»c_atomç»´å˜åˆ°Headçš„ç»´åº¦cä¸Šï¼Œç„¶åå†ç›´æ¥æ±‚sigmoidï¼Œå°†å…¶æ˜ å°„åˆ°0åˆ°1ä¹‹é—´åˆ°ä¸€ä¸ªæ•°ä¸Šä½œä¸ºgatingã€‚
                    
                    ![image.png](images/image%2017.png)
                    
                - ç„¶åelement-wiseä¹˜ä»¥attentionçš„ç»“æœï¼Œæœ€ç»ˆå°†æ‰€æœ‰çš„Head concateèµ·æ¥ï¼Œå¹¶æœ€åç»è¿‡ä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œå¾—åˆ°attentionçš„ç»“æœq_iï¼Œå½¢çŠ¶æ˜¯[C_atom]ã€‚
                    
                    ![image.png](images/image%2018.png)
                    
            - Sparse attentionï¼šå› ä¸ºåŸå­çš„æ•°é‡è¿œè¿œå¤§äºtokensçš„æ•°é‡ï¼Œæ‰€ä»¥è¿™é‡Œè®¡ç®—atom attentionçš„æ—¶å€™ï¼Œä»è®¡ç®—é‡ä¸Šæ¥è€ƒè™‘ï¼Œå¹¶ä¸ä¼šè®¡ç®—ä¸€ä¸ªåŸå­å¯¹æ‰€æœ‰åŸå­çš„attentionï¼Œè€Œæ˜¯ä¼šè®¡ç®—ä¸€ä¸ªå±€éƒ¨çš„attentionï¼Œå«åšsequence-local atom attentionï¼Œå…·ä½“çš„æ–¹æ³•æ˜¯ï¼š
                - åœ¨è®¡ç®—attentionçš„æ—¶å€™ï¼Œå°†ä¸å…³å¿ƒä½ç½®(i,j)çš„softmaxçš„ç»“æœåšåˆ°è¿‘ä¼¼äº0ï¼Œé‚£ä¹ˆç›¸å½“äºåœ¨softmaxä¹‹å‰ç‰¹å®šä½ç½®(i,j)çš„å€¼ä¸ºè´Ÿæ— ç©·å¤§ï¼Œé€šè¿‡å¼•å…¥çš„beta_i_jæ¥è¿›è¡ŒåŒºåˆ†ï¼š
                    
                    ![image.png](images/image%2019.png)
                    
                    - å¦‚æœiå’Œjä¹‹é—´çš„è·ç¦»æ»¡è¶³æ¡ä»¶ï¼Œé‚£ä¹ˆå°±æ˜¯éœ€è¦è®¡ç®—atom attentionçš„ï¼Œè¿™æ—¶å€™beta_i_jä¸º0ã€‚
                    - å¦‚æœiå’Œjä¹‹é—´è·ç¦»ä¸æ»¡è¶³æ¡ä»¶ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸éœ€è¦è®¡ç®—attentionçš„ï¼Œè¿™æ—¶å€™beta_i_jä¸º-10^10ã€‚
    3. Conditioned Gating: ã€å¯¹åº”Algorithm 24 AttentionPairBiasã€‘
        - è¾“å…¥æ˜¯cå’Œqï¼Œå½¢çŠ¶åˆ†åˆ«æ˜¯[C_atom, N_atoms], [C_atom, N_atoms]ï¼Œè¾“å‡ºæ˜¯qï¼Œå½¢çŠ¶æ˜¯ [C_atom, N_atoms]ã€‚
        - è¿™é‡Œå…¬å¼ä¸­s_iå®é™…ä¸Šå°±æ˜¯c_i ï¼Œå…ˆåšä¸€æ¬¡çº¿æ€§å˜æ¢ï¼Œç„¶ååœ¨è®¡ç®—sigmoidï¼Œå°†c_iä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ æ˜ å°„åˆ°0å’Œ1ä¹‹é—´ï¼Œæœ€ååœ¨element-wiseä¹˜ä»¥a_iï¼Œå®é™…ä¸Šå°±æ˜¯q_i, å¾—åˆ°æœ€æ–°çš„q_i:
            
            ![image.png](images/image%2020.png)
            
    4. Conditioned Transition: ã€å¯¹åº”Algorithm 25 ConditionalTransitionBlockã€‘
        - è¾“å…¥æ˜¯cï¼Œqå’Œpï¼Œå½¢çŠ¶åˆ†åˆ«æ˜¯[C_atom, N_atoms], [C_atom, N_atoms], [N_atoms, N_atoms, C_atompair]ï¼Œè¾“å‡ºæ˜¯qï¼Œå½¢çŠ¶æ˜¯[C_atom, N_atoms]ã€‚
        - Atom Transformerçš„æœ€åä¸€ä¸ªæ¨¡å—ï¼Œè¿™ä¸ªç›¸å½“äºåœ¨Transformerä¸­çš„MLPå±‚ï¼Œè¯´ä»–æ˜¯Conditionalæ˜¯å› ä¸ºä»–åŒ…å«åœ¨Adaptive LayerNormå±‚ï¼ˆå‰é¢ç¬¬ä¸‰æ­¥ï¼‰å’ŒConditional Gatingï¼ˆå‰é¢ç¬¬ä¸‰æ­¥ï¼‰ä¹‹é—´ã€‚åŒºåˆ«åªæ˜¯ä¸­é—´çš„æ˜¯MLPè¿˜æ˜¯Attentionã€‚
            - ç¬¬ä¸€æ­¥è¿˜æ˜¯ä¸€ä¸ªAdaptive LayerNormï¼š
                
                ![image.png](images/image%2021.png)
                
            - ç¬¬äºŒæ­¥æ˜¯ä¸€ä¸ªswishï¼š
                
                ![image.png](images/image%2022.png)
                
            - ç¬¬ä¸‰æ­¥æ˜¯Conditional Gatingï¼š
                
                ![image.png](images/image%2023.png)
                

## **å¦‚ä½•æ„å»ºToken-levelçš„è¡¨å¾ï¼Ÿ**

- æ„å»ºToken-levelçš„Single Sequence Representation
    - è¾“å…¥æ˜¯qï¼Œatom-level single representationï¼Œå½¢çŠ¶æ˜¯[C_atom, N_atoms]ã€‚è¾“å‡ºæ˜¯S_inputså’ŒS_initï¼Œå½¢çŠ¶åˆ†åˆ«æ˜¯[C_token+65, N_tokens]ï¼Œ[C_token, N_tokens]ã€‚
    - é¦–å…ˆå°†æ¯ä¸€ä¸ªatomçš„è¡¨ç¤ºç»´åº¦C_atomç»è¿‡çº¿æ€§å˜æ¢åˆ°C_tokenï¼Œç„¶åç»è¿‡reluæ¿€æ´»å‡½æ•°ï¼Œç„¶ååœ¨ç›¸åŒçš„tokenå†…éƒ¨ï¼Œå¯¹æ‰€æœ‰çš„atomè¡¨ç¤ºæ±‚å¹³å‡ï¼Œå¾—åˆ°N_tokenä¸ªC_tokenç»´åº¦çš„å‘é‡ã€‚ã€æ¥è‡ª Algorithm 5 AtomAttentionEncoderã€‘
        
        ![image.png](images/image%2024.png)
        
    - ç„¶åé’ˆå¯¹æœ‰MSAç‰¹å¾çš„tokenï¼Œæ‹¼æ¥ä¸Šresidue_typeï¼ˆ32ï¼‰å’ŒMSAç‰¹å¾ï¼ˆMSA propertiesï¼š32+1ï¼‰ï¼Œä»è€Œå¾—åˆ°S_inputã€‚ã€æ¥è‡ª Algorithm 2 InputFeatureEmbedderã€‘
        
        ![image.png](images/image%2025.png)
        
    - æœ€åå†è¿›è¡Œä¸€æ¬¡çº¿æ€§å˜æ¢ï¼Œä»S_inputè½¬æ¢ä¸ºS_initã€‚ã€æ¥è‡ª Algorithm 1 MainInferenceLoopã€‘
        
        ![image.png](images/image%2026.png)
        
        - æ³¨æ„ï¼šè¿™é‡Œçš„C_så°±æ˜¯C_token = 384
- æ„å»ºToken-levelçš„Pair Representation ã€æ¥è‡ª Algorithm 1 MainInferenceLoopã€‘
    - è¾“å…¥æ˜¯S_initï¼Œå½¢çŠ¶æ˜¯[C_token=384, N_tokens]ï¼Œè¾“å‡ºæ˜¯Z_initï¼Œå½¢çŠ¶æ˜¯[N_tokens, N_tokens, C_z=128]ã€‚
    - è¦è®¡ç®—Z_init_i_jï¼Œé‚£ä¹ˆéœ€è¦å¾—åˆ°ç‰¹å®šä¸¤ä¸ªtokençš„ç‰¹å¾ï¼Œå°†å…¶åˆ†åˆ«è¿›è¡Œçº¿æ€§å˜æ¢ä¹‹åï¼Œå†ç›¸åŠ å¾—åˆ°ç¬¬ä¸€ä¸ªz_i_jï¼Œå‘é‡é•¿åº¦ä»C_tokensä¹Ÿå°±æ˜¯C_s=384è½¬æ¢ä¸ºC_z=128ã€‚
        
        ![image.png](images/image%2027.png)
        
    - ç„¶ååœ¨zçš„ï¼ˆiï¼Œjï¼‰ä½ç½®åŠ å…¥ç›¸å¯¹ä½ç½®ç¼–ç ï¼š
        
        ![image.png](images/image%2028.png)
        
        - è¯¦è§£RelativePositionEncodingï¼šæ³¨æ„è¿™é‡Œçš„iå’Œjéƒ½æ˜¯æŒ‡çš„tokenã€‚ã€æ¥è‡ª Algorithm 3 RelativePositionEncodingã€‘
            
            ![image.png](images/image%2029.png)
            
            - a_residue_i_jï¼šæ®‹åŸºç›¸å¯¹ä½ç½®ä¿¡æ¯ï¼š
                - å¦‚æœiå’Œj tokenåœ¨åŒä¸€ä¸ªé“¾ä¸­ï¼Œé‚£ä¹ˆd_residue_i_j åˆ™æ˜¯iæ®‹åŸºå’Œjæ®‹åŸºç›¸å¯¹ä½ç½®ä¹‹å·®ï¼ŒèŒƒå›´åœ¨[0, 65]ã€‚
                - å¦‚æœiå’Œj tokenä¸åœ¨åŒä¸€ä¸ªé“¾ä¸­ï¼Œé‚£ä¹ˆd_residue_i_j = 2*r_max+1 = 65
                - a_residue_i_j ä¸ºä¸€ä¸ªé•¿åº¦ä¸º66çš„one-hotç¼–ç ï¼Œ1çš„ä½ç½®ä¸ºd_residue_i_jçš„å€¼ã€‚
            - a_token_i_jï¼štokenç›¸å¯¹ä½ç½®ä¿¡æ¯ï¼š
                - å¦‚æœiå’Œj tokenåœ¨åŒä¸€ä¸ªæ®‹åŸºä¸­ï¼Œï¼ˆå¯¹äºmodified æ°¨åŸºé…¸æˆ–è€…æ ¸è‹·é…¸ï¼Œé‚£ä¹ˆä¸€ä¸ªåŸå­æ˜¯ä¸€ä¸ªtokenï¼‰ï¼Œé‚£ä¹ˆd_token_i_j ä¸ºä¸åŒæ®‹åŸºåºå·ä¹‹å·®ï¼ŒèŒƒå›´åœ¨[0, 65]ã€‚
                - å¦‚æœiå’Œj tokenä¸åœ¨åŒä¸€ä¸ªæ®‹åŸºä¸­ï¼Œå–æœ€å¤§å€¼d_token_i_j = 2*r_max+1 = 65
                - a_token_i_j ä¸ºä¸€ä¸ªé•¿åº¦ä¸º66çš„one-hotç¼–ç ï¼Œ1çš„ä½ç½®ä¸ºd_token_i_jçš„å€¼ã€‚
            - a_chain_i_jï¼šé“¾ç›¸å¯¹ä½ç½®ä¿¡æ¯ï¼š
                - å¦‚æœiå’Œj tokenä¸åœ¨åŒä¸€æ¡é“¾ä¸­ï¼Œé‚£ä¹ˆd_chain_i_j ä¸ºé“¾ä¹‹é—´çš„åºå·ä¹‹å·®ï¼ŒèŒƒå›´åœ¨[0, 5]ã€‚
                - å¦‚æœiå’Œj tokenåœ¨åŒä¸€æ¡é“¾ä¸­ï¼Œé‚£ä¹ˆd_chain_i_jè®¾ç½®ä¸ºæœ€å¤§å€¼5ã€‚
                - a_chain_i_jä¸ºä¸€ä¸ªé•¿åº¦ä¸º6çš„one-hotç¼–ç ï¼Œ1çš„ä½ç½®ä¸ºd_chain_i_jçš„å€¼ã€‚
            - b_same_entity_i_jï¼šå¦‚æœiå’Œj tokenåœ¨åŒä¸€ä¸ªå®ä½“ï¼ˆå®Œå…¨ç›¸åŒçš„æ°¨åŸºé…¸åºåˆ—ä¸ºå”¯ä¸€å®ä½“ï¼Œæ‹¥æœ‰å”¯ä¸€å®ä½“idï¼‰ä¸­ï¼Œä¸º1å¦åˆ™ä¸º0.
            - æœ€åå°†[a_residue_i_j, a_token_i_j, b_same_entity_i_j, a_chain_i_j] æ‹¼æ¥èµ·æ¥ï¼Œå¾—åˆ°äº†ä¸€ä¸ªé•¿åº¦ä¸º66+66+1+6 = 139 = C_rpe çš„å‘é‡ã€‚
            - ç„¶åå†ç»è¿‡ä¸€æ¬¡çº¿æ€§å˜æ¢ï¼Œå°†å…¶å‘é‡ç»´åº¦å˜æ¢åˆ°C_z=128ç»´åº¦ã€‚
    - æœ€ååœ¨å°†tokençš„bondä¿¡æ¯åŠ å…¥ï¼Œé€šè¿‡çº¿æ€§å˜æ¢ä¹‹åï¼ŒåŠ å…¥z_i_jï¼Œå¾—åˆ°æœ€åçš„ç»“æœã€‚
        
        ![image.png](images/image%2030.png)
        

# Representation Learning

## Template Module

- Template Moduleçš„è¾“å…¥æ˜¯ä»€ä¹ˆï¼Ÿ
    - token-level pair representation { z_i_j } å’Œ åŒ…å«templateä¿¡æ¯çš„ç‰¹å¾ {**f**} ã€‚
- Template ç‰¹å¾å¦‚ä½•æ„å»ºï¼Ÿã€æ¥è‡ª Algorithm 16 TemplateEmbedderã€‘
    
    ![image.png](images/image%2031.png)
    
    1. é’ˆå¯¹template tï¼Œb_template_backbone_frame_mask_i_j é€šè¿‡å¯¹ç¬¬tä¸ªæ¨¡ç‰ˆçš„iä¸ªä½ç½®å’Œjä¸ªä½ç½®çš„template_backbone_frame_maskçš„å€¼æ¥è®¡ç®—ï¼Œå³åªæœ‰iå’Œjä½ç½®éƒ½åŒ…å«äº†å¯ä»¥ç”¨äºè®¡ç®—backboneçš„æ‰€æœ‰åŸå­ï¼Œæ­¤maskç»“æœä¸º1ï¼Œå¦åˆ™ä¸º0.
    2. åŒç†ï¼Œå¯¹ç¬¬tä¸ªæ¨¡ç‰ˆçš„iä½ç½®å’Œjä½ç½®çš„template_pseudo_beta_maskéƒ½ä¸º1ï¼Œæ­¤b_template_pseudo_beta_mask_i_jè¿™ä¸ªmaskæ‰ä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚å«ä¹‰æ˜¯ä¸­å¿ƒåŸå­åœ¨iå’Œjä½ç½®æ˜¯å¦æœ‰åæ ‡ã€‚
    3. a_t_i_j è®¡ç®—ç¬¬tä¸ªæ¨¡ç‰ˆçš„iä½ç½®å’Œjä½ç½®çš„ç›¸å…³ç‰¹å¾ï¼Œå°†template_distogram ï¼ˆè¡¨ç¤ºä¸¤ä¸ªtokenä¹‹é—´è·ç¦»ï¼Œå½¢çŠ¶ä¸º[N_templ, N_token, N_token, 39]ï¼‰çš„æœ€åä¸€ç»´å’Œb_template_backbone_frame_mask_i_jï¼ˆ1ç»´æ ‡é‡ï¼‰ï¼Œtemplate_unit_vectorï¼ˆè¡¨ç¤ºä¸¤ä¸ªtokenä¹‹é—´åŒ…å«æ–¹å‘çš„å•ä½å‘é‡ï¼Œå½¢çŠ¶ä¸º[N_templ, N_token, N_token, 3]ï¼‰çš„æœ€åä¸€ç»´ï¼Œå’Œb_template_pseudo_beta_mask_i_j (1ç»´æ ‡é‡) æ‹¼æ¥èµ·æ¥æˆä¸ºä¸€ä¸ªç»´åº¦ä¸º44çš„å‘é‡ã€‚
    4. å¦‚æœä½äºiä½ç½®çš„tokençš„å’Œjä½ç½®çš„tokenä¸åœ¨ä¸€æ¡é“¾ä¸Šï¼Œåˆ™a_t_i_j å‘é‡è®¾ç½®ä¸ºå…¨0å‘é‡ã€‚
    5. a_t_i_jå†æ‹¼æ¥ä¸Šä½äºtæ¨¡ç‰ˆçš„iä½ç½®çš„æ®‹åŸºç±»å‹(one-hot encoding) å’Œjä½ç½®çš„æ®‹åŸºç±»å‹ä¿¡æ¯ï¼Œå¾—åˆ°a_t_i_jçš„å‘é‡ä¸ºä¸€ä¸ª[44+32+32 =108]çš„å‘é‡ã€‚{a_t_i_j}çš„å½¢çŠ¶ä¸º[N_templ, N_token, N_token, 108]ã€‚
- ç„¶åé’ˆå¯¹æ¯ä¸€ä¸ªtemplateï¼Œåšç›¸åŒä»¥ä¸‹æ“ä½œï¼šã€æ¥è‡ª Algorithm 16 TemplateEmbedderã€‘
    
    ![image.png](images/image%2032.png)
    
    1. é¦–å…ˆå®šä¹‰ä¸€ä¸ªu_i_jç”¨äºå­˜æ”¾ç»“ç®—ç»“æœï¼Œ{u_i_j}çš„å½¢çŠ¶æ˜¯[N_token, N_token, c]
    2. é’ˆå¯¹æ¯ä¸€ä¸ªtemplateï¼Œè¿›è¡Œç›¸åŒçš„æ“ä½œï¼šå¯¹a_t_i_jè¿›è¡Œçº¿æ€§å˜æ¢ï¼Œä»108ç»´ â†’ cç»´ï¼Œ å¯¹z_i_jå…ˆè¿›è¡ŒLNï¼Œç„¶åå†è¿›è¡Œçº¿æ€§å˜æ¢ï¼Œä»c_zç»´ â†’ cç»´ï¼Œç„¶åé’ˆå¯¹æ¯ä¸€ä¸ªtemplateçš„a_t_i_jï¼Œéƒ½åŠ ä¸Šç›¸åŒçš„z_i_jå˜æ¢åçš„ç»“æœï¼Œå¾—åˆ°v_i_jï¼Œç»´åº¦ä¸ºcç»´ã€‚
    3. ç„¶åå°†v_i_jé€šè¿‡PairformerStackè¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°çš„ç»“æœå†åŠ ä¸Šv_i_j ä½œä¸ºv_i_jçš„ç»“æœï¼Œç»´åº¦ä¸ºcç»´ã€‚
    4. æœ€åå¯¹v_i_j è¿›è¡ŒLNä¹‹åï¼Œå¯¹äºæ‰€æœ‰çš„templateéƒ½åŠ åˆ°u_i_jå‘é‡ä¸Šï¼Œç»´åº¦ä¸ºcç»´ã€‚
- æœ€åå¯¹u_i_jçš„ç»“æœè¿›è¡Œå¹³å‡ï¼Œé™¤ä»¥templateçš„æ•°é‡ï¼Œæœ€åå†æ¿€æ´»ä¸€ä¸‹ï¼Œç„¶åç»è¿‡ä¸€æ¬¡çº¿æ€§å˜æ¢å¾—åˆ°æœ€ç»ˆçš„ç»“æœu_i_jï¼Œ {u_i_j}çš„å½¢çŠ¶ä¸º[N_token, N_token, c] ã€‚ã€æ¥è‡ª Algorithm 16 TemplateEmbedderã€‘
    
    ![image.png](images/image%2033.png)
    

## MSA Module

![image.png](images/image%2034.png)

- æ­¤æ¨¡å—çš„ç›®æ ‡ï¼šåŒæ—¶æ›´æ–°MSAå’ŒPair Representationç‰¹å¾ï¼Œå¹¶è®©å…¶ç›¸äº’å½±å“ã€‚å…ˆé€šè¿‡Outer Product Meanæ¥è®©MSAè¡¨å¾æ›´æ–°Pair Representationï¼Œç„¶åå†ä½¿ç”¨Pair Representationé€šè¿‡ row-wise gated self-attention using only pair biasæ¥æ›´æ–°MSAçš„è¡¨å¾ã€‚æœ€ç»ˆPair representationç»è¿‡ä¸€ç³»åˆ—çš„ä¸‰è§’è®¡ç®—å¹¶æœ€ç»ˆè¿›è¡Œæ›´æ–°ã€‚
- è¾“å…¥ï¼š
    - MSA è¡¨å¾ï¼ˆä¼šæŒ‰ç…§è¡Œè¿›è¡Œsubsamleï¼Œåªéšæœºé€‰å–å…¶ä¸­å°‘éƒ¨åˆ†æ ·æœ¬ï¼‰
        - f_msa: å½¢çŠ¶ä¸º [N_msa, N_token, 32]ï¼ŒåŸå§‹çš„N_msaæ¡MSAæ ·æœ¬ï¼Œæ¯ä¸€ä¸ªä½ç½®æœ‰32ç§å¯èƒ½æ€§ã€‚
        - f_has_deletion: å½¢çŠ¶ä¸º [N_msa, N_token], åŸå§‹ä¿¡æ¯ï¼ŒæŒ‡ç¤ºæ¯ä¸ªä½ç½®å·¦è¾¹æ˜¯å¦æœ‰åˆ é™¤ã€‚
        - f_deletion_value: å½¢çŠ¶ä¸º [N_msa, N_token]ï¼ŒåŸå§‹ä¿¡æ¯ï¼ŒæŒ‡ç¤ºRaw deletion countsï¼Œå¤§å°åœ¨[0,1]ä¹‹é—´ã€‚
    - S_inputs_i : åˆå§‹çš„token-level single sequenceç‰¹å¾ï¼Œå½¢çŠ¶ä¸º[N_token, C_token+65]ï¼Œè¿™é‡Œçš„65æ˜¯32+32+1ï¼Œå…¶ä¸­åŒ…å«äº†å½“å‰tokençš„restypeï¼Œä»¥åŠMSAçš„ä¸€äº›ç‰¹å¾ï¼ŒåŒ…æ‹¬åœ¨iä½ç½®çš„å„ä¸ªrestypeç±»å‹çš„åˆ†å¸ƒï¼Œä»¥åŠåœ¨iä½ç½®çš„deletion meançš„å€¼ã€‚å¦‚æœå½“å‰tokenæ²¡æœ‰MSAä¿¡æ¯ï¼Œåˆ™è¿™65ç»´éƒ½ä¸º0.
    - token-level Pair Representationï¼š{z_ij} ï¼Œå½¢çŠ¶ä¸º[N_token, N_token, C_z=128]
- è¾“å‡ºï¼šæ›´æ–°ä¹‹åçš„token-level Pair Representationï¼š{z_ij} ï¼Œå½¢çŠ¶ä¸º[N_token, N_token, C_z=128]
- ç›´æ¥çœ‹ä¼ªä»£ç ï¼š
    
    ![image.png](images/image%2035.png)
    
    1. é¦–å…ˆï¼Œé€šè¿‡å¯¹f_msa_Siï¼Œf_has_deletion_Siä»¥åŠf_deletion_Siè¿›è¡Œæ‹¼æ¥ï¼Œå¾—åˆ°ä¸€ä¸ª32+1+1=34çš„å‘é‡ï¼š**m_Si**ã€‚æ³¨æ„è¿™é‡Œçš„Så’Œiéƒ½åˆ†åˆ«æ˜¯ä¸‹æ ‡ï¼ŒSè¡¨ç¤ºåœ¨N_msaä¸­ç¬¬Sè¡Œï¼ˆç¬¬Sä¸ªæ ·æœ¬ï¼‰ï¼Œiè¡¨ç¤ºæ¯ä¸€è¡Œä¸­ç¬¬iä¸ªä½ç½®ã€‚
    2. ç„¶åé€šè¿‡SampleRandomWithoutReplacementå‡½æ•°å¯¹N_msaè¿›è¡Œsubsampleï¼Œ{S}ä»£è¡¨æ‰€æœ‰N_msaçš„å¯èƒ½çš„åºå·çš„é›†åˆï¼Œè€Œ{s}ä»£è¡¨ä¸‹é‡‡æ ·ä¹‹åçš„å¯èƒ½çš„åºå·çš„é›†åˆã€‚
    3. ç„¶å**m_si**ä»£è¡¨çš„æ˜¯é’ˆå¯¹ä¸‹é‡‡æ ·ä¹‹åçš„æ ·æœ¬çš„ç¬¬sä¸ªæ ·æœ¬ç¬¬iä¸ªä½ç½®ï¼Œç„¶åè¿›è¡Œçº¿æ€§å˜æ¢ï¼Œå°†ç»´åº¦ä»34â†’C_m=64ã€‚
    4. ç„¶ååŠ ä¸Š{S_inputs_i} è¿›è¡Œçº¿æ€§å˜æ¢åçš„ç»“æœå¾—åˆ°ä¸€ä¸ªæ–°çš„MSAç‰¹å¾ **m_si**ã€‚è¿™é‡ŒS_inputs_iä¹ŸåŒ…å«äº†MSAåœ¨æ¯ä¸€ä¸ªä½ç½®ä¸Šçš„ç›¸å…³ç‰¹å¾ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Œç»´åº¦æ˜¯ C_token+65ã€‚
    5. ç„¶åé’ˆå¯¹N_blockä¸ªblockè¿›è¡Œå¾ªç¯ï¼š
        1. å¯¹MSAä¿¡æ¯m_siè¿›è¡ŒOuterProductMeanè®¡ç®—å¹¶èåˆåˆ°pair representationä¸­ï¼š
            1. è¾“å…¥{m_si}çš„å½¢çŠ¶æ˜¯[n_msa, N_tokens, C_m]ï¼Œå…·ä½“çš„ç®—æ³•å¦‚ä¸‹ï¼š
                
                ![image.png](images/image%2036.png)
                
                1. é¦–å…ˆï¼Œå¯¹m_siè¿›è¡ŒLNï¼Œ{m_si}çš„å½¢çŠ¶ä¸º[n_msa, N_tokens, C_m]
                2. ç„¶åè¿›è¡Œçº¿æ€§å˜æ¢ï¼Œå¾—åˆ°a_siå’Œb_siï¼Œçº¿æ€§å˜æ¢æ˜¯ä»C_m=64 â†’ c=32
                3. å¯¹äºæ¯ä¸€ä¸ªsï¼Œè®¡ç®—a_siå’Œb_sjçš„å¤–ç§¯ï¼Œç›¸å½“äºè®¡ç®—å¯¹äºsè¿™ä¸ªMSAæ ·æœ¬æ¥è¯´ï¼Œè®¡ç®—å…¶iä½ç½®å’Œjä½ç½®çš„å…³ç³»ï¼Œé€šè¿‡å¤–ç§¯æ¥è®¡ç®—ã€‚
                    1. é•¿åº¦ä¸ºcçš„å‘é‡ä¸é•¿åº¦ä¸ºcçš„å‘é‡çš„å¤–ç§¯çš„è®¡ç®—å¾—åˆ°ä¸€ä¸ª[c , c]çŸ©é˜µï¼Œ
                    2. ç„¶åå°†sä¸ª[c, c]çš„çŸ©é˜µæŒ‰æ¯ä¸ªä½ç½®(i,j)æ±‚å¹³å‡ï¼Œ
                    3. æœ€åå°†è¿™ä¸ªçŸ©é˜µå˜æˆä¸€ä¸ªä¸€ç»´å‘é‡ï¼Œå¾—åˆ°o_ijï¼Œå½¢çŠ¶ä¸ºc*cã€‚
                4. æœ€ååœ¨ç»è¿‡ä¸€æ¬¡çº¿æ€§å˜æ¢ï¼Œå°†c*c â†’ c_z=128 ç»´åº¦ï¼Œå¾—åˆ°æœ€ç»ˆçš„z_ijï¼Œå³é€šè¿‡MSAè®¡ç®—å¾—åˆ°ä½ç½®ä¹‹é—´çš„ä¿¡æ¯ã€‚
                
                æ³¨1ï¼šè¿™é‡Œé€šè¿‡OuterProductMeanæ–¹æ³•ï¼Œå°†MSAçš„è¡¨å¾èåˆåˆ°pair representationä¸­å»ã€‚å¯¹äºåŒä¸€ä¸ªMSAåºåˆ—ï¼Œé€šè¿‡å¤–ç§¯çš„æ–¹å¼å¾—åˆ°å…¶ä»»æ„ä¸¤ä¸ªä½ç½®ä¹‹é—´çš„å…³ç³»ï¼Œç„¶åå¯¹æ‰€æœ‰çš„MSAåºåˆ—çš„è¿™ä¸¤ä¸ªä½ç½®çš„ç»“æœæ±‚å¹³å‡ï¼Œå¾—åˆ°ä»»æ„ä¸¤ä¸ªä½ç½®ä¹‹é—´åœ¨è¿›åŒ–ä¸Šçš„å…³ç³»ä¿¡æ¯å¹¶èåˆåˆ°pair representationä¸­å»ã€‚
                
                æ³¨2ï¼šæ³¨æ„åˆ°è¿™é‡Œæ˜¯ä»…ä»…åœ¨è¿›åŒ–åºåˆ—å†…éƒ¨è¿›è¡Œè®¡ç®—ï¼Œç„¶åè¿›åŒ–åºåˆ—ä¹‹é—´çš„ä¿¡æ¯æ˜¯å”¯ä¸€ä¸€æ¬¡é€šè¿‡å¹³å‡çš„æ–¹å¼èåˆåœ¨ä¸€èµ·ï¼Œé¿å…äº†AF2ä¸­è¿›åŒ–åºåˆ—ä¹‹é—´å¤æ‚çš„è®¡ç®—ã€‚
                
        2. ä½¿ç”¨æ›´æ–°åçš„pair representationå’Œm_siæ¥æ›´æ–°m_si(MSAç‰¹å¾): MSA row-wise gated self-attention using only pair bias
            1. è¾“å…¥æ˜¯{m_si}çš„å½¢çŠ¶æ˜¯[n_msa, N_tokens, C_m=64]ï¼Œ {z_ij}çš„å½¢çŠ¶æ˜¯[N_token, N_token, C_z=128]ã€‚è¾“å‡ºæ˜¯{m_si}ï¼Œå½¢çŠ¶æ˜¯[n_msa, N_tokens, C_m=64]ã€‚å…·ä½“çš„ç®—æ³•å¦‚ä¸‹ï¼š
                
                ![image.png](images/image%2037.png)
                
                1. é¦–å…ˆå¯¹MSAç‰¹å¾m_siè¿›è¡ŒLNã€‚
                2. ç„¶åå¯¹m_siè¿›è¡Œå¤šå¤´çº¿æ€§å˜æ¢ï¼Œå¾—åˆ°H_headä¸ªå¤´v_h_siï¼Œçº¿æ€§å˜æ¢ç»´åº¦ä»C_mâ†’ cã€‚
                3. å¯¹pair represnetationç‰¹å¾z_ijé¦–å…ˆè¿›è¡ŒLNï¼Œç„¶åè¿›è¡Œå¤šå¤´çº¿æ€§å˜æ¢ï¼Œå¾—åˆ°b_h_ijï¼Œç»´åº¦ä»C_zâ†’1ã€‚
                4. å¯¹m_siè¿›è¡Œå¤šå¤´çº¿æ€§å˜æ¢ï¼Œç»´åº¦ä»C_mâ†’cï¼Œç„¶åè®¡ç®—å…¶sigmoidçš„å€¼ï¼Œå¾—åˆ°g_h_siï¼Œç”¨äºåç»­åšgatingã€‚
                5. å¯¹b_h_ijæ²¿ç€jçš„æ–¹å‘åšsoftmaxï¼Œå¾—åˆ°weight w_h_ijï¼Œç»´åº¦ä¸º1ã€‚
                6. è¿™é‡Œæ¯”è¾ƒéš¾ç†è§£çš„æ˜¯å¦‚ä½•å¾—åˆ°o_h_siï¼Œè¿™é‡Œv_h_sjå’Œw_h_ijåœ¨jæ–¹å‘ä¸ŠæŒ‰å…ƒç´ ç›¸ä¹˜ï¼Œç„¶ååŠ èµ·æ¥å¾—åˆ°o_h_siçš„ä¸­é—´ç»“æœã€‚
                    1. å³é€šè¿‡å¯¹äº{w_h_ij}è¿™ä¸ªå½¢çŠ¶ä¸º[N_token, N_token]çš„çŸ©é˜µï¼Œå–å…¶ç¬¬iè¡Œçš„å…ƒç´ [N_token]ã€‚
                    2. å¯¹{v_h_sj}è¿™ä¸ªå½¢çŠ¶ä¸º[n_msa, N_token, c]çš„çŸ©é˜µå–å…¶ç¬¬sè¡Œçš„å…ƒç´ [N_token, c]ã€‚
                    3. å°†å…¶è¿›è¡ŒæŒ‰å…ƒç´ ç›¸ä¹˜å¹¶åŠ æ€»èµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªcç»´åº¦çš„å‘é‡ï¼Œå…¶çš„ä½ç½®ä¸ºåŸæ¥{m_si}çŸ©é˜µçš„sè¡Œå’Œiåˆ—ã€‚
                    4. o_h_si å†åœ¨cç»´åº¦ä¸ŠæŒ‰å…ƒç´ ä¹˜ä»¥g_h_siï¼Œè¿›è¡Œgatingã€‚
                7. æœ€åé’ˆå¯¹o_h_siï¼Œå°†å…¶H_headä¸ªå¤´concateèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªc*H_headé•¿çš„å‘é‡ï¼Œç„¶åç»è¿‡çº¿æ€§å˜æ¢åå¾—åˆ°æœ€ç»ˆç»“æœm^_siã€‚
            2. æ³¨æ„ï¼Œè¿™éƒ¨åˆ†æ˜¯é€šè¿‡pair representationæ¥æ›´æ–°MSAçš„è¡¨å¾ï¼Œæ›´æ–°æ–¹å¼æ˜¯å¯¹æ¯ä¸€ä¸ªMSAçš„åºåˆ—æ¥è¯´ï¼Œå…¶æ›´æ–°æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚ç„¶åä½¿ç”¨pair representationä¸­çš„ä½ç½®ä¹‹é—´çš„å…³ç³»æ¥æ„å»ºweightï¼Œç›¸å½“äºç»™m_siä¸­çš„æ¯ä¸€ä¸ªä½ç½®åšäº†ä¸€æ¬¡self-attentionï¼Œå¼•å…¥äº†pair representationä¸­çš„ä¿¡æ¯ã€‚
        3. {m_si} å†ç»è¿‡ä¸€å±‚transitionå±‚åå†ä½œä¸ºä¸‹ä¸€ä¸ªblockçš„{m_si}çš„è¾“å…¥ã€‚
        4. pair representation {z_ij}ç»è¿‡ä¸€ç³»åˆ—çš„ä¸‰è§’è®¡ç®—å’Œtransitionåï¼Œå†ä½œä¸ºä¸‹ä¸€ä¸ªblock{m_si}çš„è¾“å…¥ã€‚

## Pairformer Module

![image.png](images/image%2038.png)

- é¦–å…ˆäº†è§£Pairformerè¿™éƒ¨åˆ†æ¨¡å—ä¸»è¦åšäº†ä»€ä¹ˆäº‹æƒ…ï¼šPair Representationä¼šè¿›è¡Œä¸‰è§’æ›´æ–°å’Œä¸‰è§’æ³¨æ„åŠ›è®¡ç®—ï¼Œå¹¶ä¸”ç”¨äºæ›´æ–°Single Representationã€‚å’ŒAF2ä¸åŒçš„æ˜¯ï¼Œè¿™é‡ŒSingle Representationä¸ä¼šå»å½±å“Pair Representationã€‚
- è¾“å…¥è¾“å‡ºï¼šè¾“å…¥æ˜¯token-level pair representation {z_ij} å’Œ token-level single representation {s_i} ï¼Œä»–ä»¬çš„å½¢çŠ¶åˆ†åˆ«æ˜¯[N_token, N_token, C_z=128] å’Œ [N_token, C_s=C_token=384]ã€‚
- ä¸ºä»€ä¹ˆè¦å…³æ³¨ä¸‰è§’å…³ç³»ï¼Ÿï¼ˆWhy look at Trianglesï¼Ÿï¼‰
    - ä¸‰è§’ä¸ç­‰å¼è¯´ï¼šä¸‰è§’å½¢ä»»æ„ä¸¤è¾¹ä¹‹å’Œå¤§äºç¬¬ä¸‰è¾¹ã€‚è€Œåœ¨pair representation ä¸­è¡¨å¾äº†ä»»æ„ä¸¤ä¸ªtokenä¹‹é—´çš„å…³ç³»ï¼Œä¸ºäº†ç®€åŒ–ç†è§£ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶çœ‹ä½œæ˜¯ä¸€ä¸ªåºåˆ—ä¸­ä»»æ„ä¸¤ä¸ªæ°¨åŸºé…¸ä¹‹é—´çš„è·ç¦»ï¼Œé‚£ä¹ˆz_ijä»£è¡¨iæ°¨åŸºé…¸å’Œjæ°¨åŸºé…¸ä¹‹é—´çš„è·ç¦»ï¼Œé‚£ä¹ˆå·²çŸ¥z_ij=1, z_jk=1ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“z_ik < 2ã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥é€šè¿‡z_ijå’Œz_jkçš„è·ç¦»æ¥ç¡®å®šz_ikçš„è·ç¦»çš„èŒƒå›´ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥é€šè¿‡z_ijå’Œz_jkæ¥çº¦æŸz_ikå¯èƒ½çš„å€¼ï¼Œæ•…ä¸‰è§’æ›´æ–°å’Œä¸‰è§’æ³¨æ„åŠ›æœºåˆ¶å°±æ˜¯ä¸ºäº†å°†è¿™ç§å‡ ä½•çº¦æŸç¼–ç åˆ°æ¨¡å‹ä¹‹ä¸­ã€‚
    - æ‰€ä»¥ï¼Œz_ijçš„å€¼å¯ä»¥é€šè¿‡è·å–æ‰€æœ‰å¯èƒ½çš„kå¾—åˆ°çš„ï¼ˆz_ikï¼Œz_jkï¼‰æ¥è¿›è¡Œæ›´æ–°ï¼Œç”±äºçœŸå®æƒ…å†µæ˜¯ï¼Œz_ijå¹¶ä¸ä»…ä»…åŒ…å«äº†è·ç¦»ä¿¡æ¯ï¼Œå®ƒä»£è¡¨äº†iå’Œjä¹‹é—´çš„å…³ç³»ä¿¡æ¯ï¼Œå› æ­¤å®ƒä¹Ÿæ˜¯æœ‰æ–¹å‘çš„ï¼Œz_ijå’Œz_jiè¡¨ç¤ºçš„å«ä¹‰æ˜¯ä¸ä¸€æ ·çš„ã€‚
    - å¹¶ä¸”åŸºäºå›¾ï¼ˆgraphï¼‰è®¡ç®—ç†è®ºï¼Œå°†ä¸‰è§’å…³ç³»ä¸­ï¼Œç”¨äºæ›´æ–°z_ijè¿™ä¸€æ¡è¾¹çš„å¦å¤–ä¸¤è¾¹çš„æ–¹å‘åˆ†ä¸ºincomingå’Œoutgoingã€‚åˆ™é’ˆå¯¹z_ijï¼Œ
        
        ![image.png](images/image%2039.png)
        
        - å…¶outgoing edgesæ˜¯ï¼šz_ik, z_jk
        - å…¶incoming edgesæ˜¯ï¼šz_ki, z_kj
    - ä¸ºä»€ä¹ˆè¦åŒºåˆ†outgoing edgeså’Œincoming edgesï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½æ··ç”¨ï¼Ÿ â†’ å½“å‰æš‚æ—¶çš„ç†è§£æ˜¯ï¼Œä¸¤æ¡è¾¹åŒæ—¶ä»iå’ŒjæŒ‡å‘kæˆ–è€…åŒæ—¶ä»kæŒ‡å‘iå’Œjï¼Œå› ä¸ºedgeæ˜¯æœ‰æ–¹å‘æ€§çš„ï¼ŒåŒæ—¶ä»iå’ŒjæŒ‡å‘kæˆ–ç›¸åï¼Œè¿™ä¸¤æ¡è¾¹çš„ç‰©ç†å«ä¹‰æ˜¯ä¸€è‡´çš„ï¼Œå°±æ˜¯iå’Œjå¯¹kçš„å…³ç³»ï¼ˆæˆ–ç›¸åï¼‰ï¼Œæ›´åŠ ä¾¿äºæ¨¡å‹å‡†ç¡®åœ°å»ºæ¨¡ã€‚ï¼ˆè¿™é‡Œçš„ç†è§£è¿˜æ˜¯ä¸å¤Ÿé€å½»ï¼Œç­‰æœ‰æœºä¼šå†æ¢³ç†ã€‚ï¼‰
- æ¥ä¸‹æ¥çœ‹çœ‹å…·ä½“æ˜¯å¦‚ä½•è®¡ç®—trianglar updateå’Œtriangular attentionæ˜¯å¦‚ä½•è®¡ç®—çš„ï¼š
    - Triangular Update
        - Outgoingï¼š
            - å…·ä½“çš„ç®—æ³•å®ç°ï¼š
                
                ![image.png](images/image%2040.png)
                
                1. z_i_j è¿™ä¸ªå‘é‡ï¼Œè‡ªå·±è¿›è¡ŒLayerNormï¼Œå³åœ¨c_zç»´åº¦ä¸Šè¿›è¡Œå½’ä¸€åŒ–ã€‚
                2. z_i_jè¿›è¡Œçº¿æ€§å˜æ¢ï¼Œè½¬æ¢ä¸ºç»´åº¦ä¸ºc=128çš„å‘é‡ï¼Œç„¶åæ¯ä¸€ä¸ªä½ç½®è®¡ç®—sigmoidçš„å€¼ï¼Œç„¶åå’Œå¦å¤–ä¸€ä¸ªè¿›è¡Œäº†çº¿æ€§å˜æ¢çš„å‘é‡è¿›è¡ŒæŒ‰å…ƒç´ ç›¸ä¹˜ï¼Œå¾—åˆ°ä¸€ä¸ªa_i_j æˆ–è€…b_i_jï¼Œç»´åº¦æ˜¯cç»´ã€‚
                3. ç„¶åè¿˜æ˜¯å¯¹z_j_jå…ˆè¿›è¡Œçº¿æ€§å˜æ¢ï¼ˆå˜æ¢ç»´åº¦ä¸å˜ï¼Œè¿˜æ˜¯c_zï¼‰ï¼Œç„¶åè®¡ç®—sigmoidï¼Œå¾—åˆ°g_i_jï¼Œç»´åº¦æ˜¯c_zï¼Œè¿™ä¸ªå‘é‡ç”¨äºgatingã€‚
                4. æœ€åï¼Œè®¡ç®—Triangular Updateï¼Œè¦æ›´æ–°z_i_jï¼Œé‚£ä¹ˆéœ€è¦ä»a_i_kå’Œb_j_kçš„è®¡ç®—ä¸­å¾—åˆ°ï¼ˆkæœ‰N_tokenä¸ªé€‰æ‹©ï¼‰ã€‚å…·ä½“æ–¹æ³•æ˜¯ï¼šé‚£ä¹ˆä»{a_i_j}ä¸­é€‰å–iè¡Œï¼Œå¾—åˆ°{a_i}ï¼ˆæœ‰N_tokenä¸ªå‘é‡ï¼‰ï¼Œä»{b_i_j}ä¸­é€‰å–jè¡Œï¼Œå¾—{b_j}ï¼ˆæœ‰N_tokenä¸ªå‘é‡ï¼‰ï¼Œç„¶åå¯¹{a_i}å’Œ{b_j}ä¸­çš„ç¬¬kä¸ªå…ƒç´ ï¼Œè®¡ç®—æŒ‰å…ƒç´ ç›¸ä¹˜ï¼Œå¾—åˆ°ä¸€ä¸ªcç»´çš„å‘é‡ï¼Œç„¶åå†å°†æ‰€æœ‰çš„N_tokenä¸ªå‘é‡åŠ èµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªcç»´åº¦çš„å‘é‡ï¼Œç„¶åè¿›è¡ŒLayerNormè®¡ç®—ï¼Œæœ€åè¿›è¡Œçº¿æ€§å˜æ¢å¾—åˆ°ä¸€ä¸ªc_zç»´åº¦çš„å‘é‡ï¼›æœ€åæŒ‰ç…§å…ƒç´ ç›¸ä¹˜g_i_jï¼Œå¾—åˆ°æœ€ç»ˆçš„z_i_jçš„ç»“æœã€‚
            - å›¾ç¤ºåŒ–è§£é‡Šï¼š
                
                ![image.png](images/image%2041.png)
                
        - Incomingï¼š
            - å…·ä½“çš„ç®—æ³•å®ç°ï¼š
                
                ![image.png](images/image%2042.png)
                
                - æ³¨æ„è¿™é‡Œçš„ä¸»è¦å˜åŒ–ï¼Œå°±æ˜¯è®¡ç®—çš„æ˜¯a_k_iå’Œb_k_jï¼Œå³ä»åˆ—çš„è§’åº¦è¿›è¡Œè®¡ç®—ï¼Œå’Œå‰é¢çš„è®¡ç®—æ–¹æ³•åˆšå¥½å¯¹ç§°ã€‚ä»ä¸‹é¢çš„å›¾ç¤ºä¹Ÿå¯ä»¥æ˜æ˜¾çš„çœ‹å‡ºæ¥ã€‚
            - å›¾ç¤ºåŒ–è§£é‡Šï¼š
                
                ![image.png](images/image%2043.png)
                
    - Triangular Attention
        - Triangular Attention (Starting Node å¯¹åº”outgoing edges)
            - å…·ä½“ç®—æ³•å®ç°ï¼š
                
                ![image.png](images/image%2044.png)
                
                1. é¦–å…ˆå¯¹z_i_j è¿›è¡ŒLayerNormå½’ä¸€åŒ–å¤„ç†ã€‚
                2. é’ˆå¯¹N_headä¸ªå¤´çš„ç‰¹å®šhå¤´ï¼Œå¯¹z_i_jè¿›è¡Œä¸åŒçš„çº¿æ€§å˜æ¢ï¼Œå¾—åˆ°q_h_i_j, k_h_i_j, v_h_i_jï¼Œç»´åº¦å˜æ¢å‡ä¸ºc_z â†’ cã€‚
                3. é’ˆå¯¹N_headä¸ªå¤´çš„ç‰¹å®šhå¤´ï¼Œå¯¹z_i_jè¿›è¡Œçº¿æ€§å˜æ¢ï¼Œå¾—åˆ°b_h_i_jã€‚ç»´åº¦å˜æ¢ä¸ºc_z â†’ 1ã€‚ 
                4. é’ˆå¯¹N_headä¸ªå¤´çš„ç‰¹å®šhå¤´ï¼Œå¯¹z_i_jå…ˆè¿›è¡Œçº¿æ€§å˜æ¢ï¼Œç»´åº¦å˜æ¢ä¸ºc_z â†’ cï¼Œç„¶åæ¯ä¸€ä¸ªå…ƒç´ è®¡ç®—sigmoidçš„å€¼ï¼Œå¾—åˆ°g_h_i_jç”¨äºåç»­çš„gatingã€‚
                5. è®¡ç®—Triangular Attention ç¬¬ä¸€æ­¥ï¼šè®¡ç®—attention scoreï¼Œé’ˆå¯¹q_h_i_jå’Œk_h_i_kè®¡ç®—ç‚¹ç§¯ï¼Œç„¶åå†é™¤ä»¥sqrt(c)ï¼Œç„¶åå†åŠ ä¸Šb_h_j_kè¿™ä¸ªç»´åº¦ä¸º1çš„å€¼ï¼Œå¾—åˆ°çš„ä¸€ä¸ªæ ‡é‡å†åœ¨kç»´åº¦ä¸Šè®¡ç®—softmaxçš„å€¼ï¼Œå¾—åˆ°åœ¨kä½ç½®ä¸Šçš„attention score a_h_i_j_kã€‚è¿™æ˜¯ä¸€ä¸ªæ ‡é‡å€¼ï¼Œé¡µå¯ä»¥ç†è§£æ˜¯ä¸€ä¸ªweightçš„å€¼ï¼Œç”¨äºåç»­ä¹˜ä»¥valueã€‚
                6. è®¡ç®—Tiangular Attention ç¬¬äºŒæ­¥ï¼šè®¡ç®—(i,j)ä½ç½®ä¸Šçš„attentionçš„ç»“æœï¼Œé€šè¿‡a_h_i_j_k ä¸ v_h_i_k çš„weighted sumï¼Œå¾—åˆ°attentionåœ¨(i,j)ä½ç½®ä¸Šçš„å€¼ï¼Œè¿™æ˜¯ä¸€ä¸ªç»´åº¦ä¸ºcçš„å‘é‡ï¼›ç„¶åä¸g_h_i_jè¿›è¡ŒæŒ‰å…ƒç´ ç›¸ä¹˜ï¼Œå¾—åˆ°gatingä¹‹åçš„attentionå‘é‡o_h_i_jï¼Œç»´åº¦ä¹Ÿä¸ºcã€‚
                7. æœ€åé’ˆå¯¹{i,j}ä½ç½®çš„å€¼ï¼Œå°†å¤šå¤´è¿›è¡Œåˆå¹¶ï¼Œé¦–å…ˆæŒ‰ç…§hä¸ªå¤šå¤´ï¼Œåœ¨æœ€åä¸€ä¸ªç‰¹å¾ç»´åº¦è¿›è¡Œæ‹¼æ¥ï¼Œç»´åº¦å˜åŒ–ï¼šc â†’ h*cï¼›ç„¶åå†è¿›è¡Œä¸€æ¬¡çº¿æ€§å˜æ¢ï¼Œå°†ç»´åº¦ä» h*c â†’ c å¾—åˆ°æœ€ç»ˆçš„ç»“æœz_i_jã€‚
            - å›¾ç¤ºåŒ–è§£é‡Šï¼š
                
                ![image.png](images/image%2045.png)
                
                - è¿™é‡Œæ³¨æ„ï¼Œå…¶å®è¿™é‡Œçš„Triangular Attentionå°±æ˜¯ä¸€ç§Axial Attentionçš„å˜ç§ï¼Œå¢åŠ äº†b_j_kä½œä¸ºbiasï¼Œå¢åŠ äº†gatingçš„æœºåˆ¶ã€‚ä½†æ˜¯å¦‚æœæŠ›å¼€è¿™ä¸¤ä¸ªå¢åŠ åˆ°ç‰¹æ€§ï¼Œç›¸å½“äºæ˜¯æŒ‰è¡Œåœ¨åšself-attentionã€‚
        - Triangular Attention (Ending Node å¯¹åº”incoming edges)
            - å…·ä½“ç®—æ³•å®ç°
                
                ![image.png](images/image%2046.png)
                
                - è¿™é‡Œçš„ä¸»è¦åŒºåˆ«åœ¨è®¡ç®—Triangular Attentionçš„æ–¹æ³•ï¼š
                    1. ä½¿ç”¨q_h_i_j å’Œ k_h_k_j æ¥è®¡ç®—attention scoreï¼Œç„¶åå†åŠ ä¸Šb_h_k_i è¿™ä¸ªåç½®ï¼Œä½œä¸ºa_h_i_j_kçš„ç»“æœã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯q_h_i_jæ˜¯å’Œk_h_k_jè€Œä¸æ˜¯å’Œk_h_k_iæ¥æ±‚ç‚¹ç§¯ï¼ŒåŠ ä¸Šçš„æ˜¯b_h_k_iè€Œä¸æ˜¯b_h_k_jã€‚åŸå› æˆ‘çŒœæµ‹æ˜¯ä¸ºäº†æ–¹ä¾¿è¿˜æ˜¯è®¡ç®—Axial Attentionï¼Œå¦åˆ™å°±ä¸æ˜¯åŸºäºåˆ—çš„self-attentionäº†ã€‚å…·ä½“å¯ä»¥è§ä¸‹é¢å›¾ç¤ºã€‚
            - å›¾ç¤ºåŒ–è§£é‡Š
                
                ![image.png](images/image%2047.png)
                
                - åŸæ¥çš„å›¾è§£æ˜¯é”™è¯¯çš„ï¼Œå…¶å¹¶æ²¡æœ‰å¿ å®æŒ‰ç…§å®˜æ–¹æ–‡æ¡£ä¸­çš„å®ç°è¿›è¡Œå›¾ç¤ºï¼Œçº¢è‰²æ¡†éƒ¨åˆ†ä¿®æ”¹äº†åŸæ¥é€”ä¸­çš„é”™è¯¯æ ‡æ³¨ã€‚
            
- æœ€åçœ‹çœ‹Single Attention with pair bias å¦‚ä½•å®ç°ã€‚
    - è¾“å…¥æ˜¯token-level single representation {s_i} å’Œtoken-level pair representatoin {z_i_j} , è¾“å‡ºæ˜¯{s_i}ã€‚
    - ä¸»è¦ä½¿ç”¨{z_i_j}ä½œä¸ºåç½®ï¼ŒåŠ å…¥åˆ°{s_i}çš„self-attentionè®¡ç®—ä¸­ï¼ŒåŒæ—¶{s_i}çš„self-attentionä¸­ä¹Ÿå¢åŠ äº†gatingçš„æœºåˆ¶ã€‚
    - å…·ä½“ç®—æ³•ä¼ªä»£ç å®ç°ä¸ºï¼š
        
        ![image.png](images/image%2048.png)
        
        - single representation {s_i} è¿›è¡Œå½’ä¸€åŒ–è®¡ç®—ã€‚
        - ä»{s_i} è®¡ç®—ç‰¹å®šhå¤´çš„qã€kã€vè¡¨ç¤ºï¼šq_h_i , k_h_i, v_h_i éƒ½ç»è¿‡äº†çº¿æ€§å˜æ¢ä»c_token â†’ cã€‚
        - ä»pair representation {z_i_j} ä¸­è®¡ç®—ä¸€ä¸ªåç½®çš„å€¼ï¼Œå‡†å¤‡åº”ç”¨åœ¨{s_i}çš„self-attentionä¸­ï¼šé¦–å…ˆ{z_i_j}è¿›è¡Œå½’ä¸€åŒ–ï¼Œç„¶åè¿›è¡Œçº¿æ€§å˜æ¢ï¼Œç»´åº¦ä»c_z â†’ 1 ï¼Œå¾—åˆ°b_h_i_jã€‚
        - ä½¿ç”¨{s_i}è®¡ç®—åç»­ç”¨äºgatingçš„å€¼ï¼šå…ˆå¯¹{s_i}è¿›è¡Œçº¿æ€§å˜æ¢c_token â†’ c ,ç„¶åå¯¹äºå…¶ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ è®¡ç®—sigmoidçš„å€¼ï¼Œå¾—åˆ°g_h_iã€‚
        - ç„¶åè®¡ç®—attentionï¼Œå®é™…ä¸Šå°±æ˜¯æ­£å¸¸çš„self-attentionï¼Œåªæ˜¯åœ¨è®¡ç®—attention scoreçš„æ—¶å€™ï¼ŒåŠ å…¥äº†æ¥è‡ªäºpair representationçš„åç½®çš„å€¼b_h_i_jï¼Œä»è€Œå¾—åˆ°æ ‡é‡ï¼ŒA_h_i_jã€‚
        - ç„¶åä½¿ç”¨v_h_jå¯¹æ¯ä¸€ä¸ªjä¹˜ä»¥A_h_i_jï¼Œå¹¶æ±‚å’Œï¼Œå¾—åˆ°ä¸€ä¸ªç»è¿‡weighted sumçš„å‘é‡ï¼Œç„¶åå†æŒ‰å…ƒç´ ä¹˜g_h_iï¼Œå¾—åˆ°ç‰¹å®šhå¤´ä¸Šçš„attentionç»“æœï¼Œç„¶åå°†å…¶ç»“æœæŒ‰ç…§æœ€åä¸€ç»´æ‹¼æ¥èµ·æ¥ï¼Œå¹¶æœ€ç»ˆé€šè¿‡ä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œå¾—åˆ°ç»è¿‡attentionä¹‹åçš„{s_i}çš„ç»“æœï¼Œç»´åº¦ä¸ºc_tokenã€‚
    - å…·ä½“çš„å›¾ç¤ºåŒ–è§£é‡Šå¦‚ä¸‹ï¼š
        
        ![image.png](images/image%2049.png)
        

# Structure Prediction

## Diffusionçš„åŸºæœ¬æ¦‚å¿µ

- åœ¨Alphafold3ä¸­æ•´ä¸ªçš„ç»“æ„é¢„æµ‹æ¨¡å—é‡‡ç”¨çš„æ–¹æ³•æ˜¯atom-levelçš„diffusionã€‚ç®€å•æ¥è®²ï¼Œdiffusionçš„å…·ä½“æ˜¯æŒ‰ç…§å¦‚ä¸‹æ–¹å¼å·¥ä½œçš„ï¼š
    - ä»æœ€çœŸå®çš„åŸå§‹æ•°æ®å¼€å§‹ï¼Œå‡è®¾æ˜¯ä¸€å¼ çœŸå®çš„ç†ŠçŒ«ç…§ç‰‡ï¼Œç„¶åå‘¢ä¸æ–­å¯¹è¿™å¼ ç…§ç‰‡åŠ å…¥éšæœºå™ªå£°ï¼Œç„¶åè®­ç»ƒæ¨¡å‹æ¥é¢„æµ‹åŠ å…¥äº†ä»€ä¹ˆæ ·çš„å™ªå£°ã€‚
    - å…·ä½“çš„æ­¥éª¤å¦‚ä¸‹ï¼š
        - è®­ç»ƒé˜¶æ®µï¼š
            - åŠ å™ªå£°è¿‡ç¨‹ï¼š
                1. å‡è®¾x(t=0)æ˜¯åŸå§‹çš„æ•°æ®ï¼Œåœ¨ç¬¬ä¸€ä¸ªæ—¶é—´æ­¥ï¼Œå¯¹æ•°æ®ç‚¹x(t=0)æ·»åŠ ä¸€éƒ¨åˆ†å™ªå£°ï¼Œå¾—åˆ°x(t=1)ã€‚
                2. åœ¨ç¬¬äºŒä¸ªæ—¶é—´æ­¥ï¼Œå¯¹x(t=1)æ·»åŠ å™ªå£°ï¼Œå¾—åˆ°x(t=2)ã€‚
                3. æŒç»­é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç»è¿‡Tæ­¥ä¹‹åï¼Œæ•°æ®å®Œå…¨è¢«å™ªå£°è¦†ç›–ï¼Œæˆä¸ºéšæœºå™ªå£°x(t=T)ã€‚
            - æ¨¡å‹çš„ç›®æ ‡ï¼šç»™å®šæŸä¸€ä¸ªè¢«å™ªå£°æ±¡æŸ“çš„æ•°æ®ç‚¹x(t)å’Œæ—¶é—´æ­¥tï¼Œæ¨¡å‹éœ€è¦é¢„æµ‹è¿™ä¸ªæ•°æ®ç‚¹æ˜¯å¦‚ä½•ä»ä¸Šä¸€æ­¥x(t-1)è½¬å˜è€Œæ¥ï¼Œå³æ¨¡å‹éœ€è¦é¢„æµ‹åœ¨x(t-1)åˆ°x(t)æ·»åŠ äº†ä»€ä¹ˆå™ªå£°ã€‚
            - æŸå¤±å‡½æ•°ï¼šæ¨¡å‹çš„é¢„æµ‹å™ªå£°å’Œå®é™…æ·»åŠ çš„å™ªå£°ä¹‹é—´çš„å·®å¼‚ã€‚
        - é¢„æµ‹é˜¶æ®µï¼š
            - å»å™ªå£°çš„è¿‡ç¨‹ï¼š
                1. ä»çº¯éšæœºå™ªå£°å¼€å§‹ï¼Œx(t=T)æ˜¯å®Œå…¨éšæœºçš„å™ªå£°ã€‚
                2. åœ¨æ¯ä¸€ä¸ªæ—¶é—´æ­¥tï¼Œæ¨¡å‹é¢„æµ‹è¿™ä¸€æ­¥åº”è¯¥ç§»é™¤çš„å™ªå£°ï¼Œç„¶åå»é™¤è¿™äº›å™ªå£°ï¼Œå¾—åˆ°x(t-1)ã€‚
                3. é‡å¤è¿™ä¸€è¿‡ç¨‹ï¼Œé€æ­¥ä»x(t=T)ç§»åˆ°x(t=0)ã€‚
                4. æœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå»å™ªå£°ä¹‹åçš„æ•°æ®ç‚¹ï¼Œåº”è¯¥çœ‹èµ·æ¥åƒè®­ç»ƒæ•°æ®ã€‚
- ä»€ä¹ˆæ˜¯æ¡ä»¶æ‰©æ•£ï¼ˆConditional Diffusionï¼‰ï¼Ÿ
    - åœ¨æ‰©æ•£æ¨¡å‹ä¸­ï¼Œæ¨¡å‹è¿˜å¯ä»¥åŸºäºæŸäº›è¾“å…¥ä¿¡æ¯æ¥â€œæ§åˆ¶â€ç”Ÿæˆçš„ç»“æœï¼Œè¿™å°±æ˜¯æ¡ä»¶æ‰©æ•£ã€‚
    - æ‰€ä»¥ä¸è®ºåœ¨è®­ç»ƒè¿˜æ˜¯é¢„æµ‹çš„è¿‡ç¨‹ä¸­ï¼Œåœ¨æ¯ä¸€ä¸ªæ—¶é—´æ­¥ä¸Šï¼Œæ¨¡å‹çš„è¾“å…¥åº”è¯¥åŒ…æ‹¬ï¼š
        - å½“å‰çš„åœ¨tæ—¶åˆ»çš„æ•°æ®ç‚¹x(t)ã€‚
        - å½“å‰çš„æ—¶é—´æ­¥tã€‚
        - æ¡ä»¶ä¿¡æ¯ï¼ˆå¦‚è›‹ç™½è´¨çš„å±æ€§ç­‰ä¿¡æ¯ï¼Œè¿™é‡Œä¸»è¦è¿˜æ˜¯æŒ‡çš„token-levelå’Œatom-levelçš„singleå’Œpair representation ä½œä¸ºæ¡ä»¶ä¿¡æ¯ï¼‰ã€‚
    - æ¨¡å‹çš„è¾“å‡ºï¼šé¢„æµ‹çš„ä»x(t-1)åˆ°x(t)æ·»åŠ åˆ°å™ªå£°ï¼ˆè®­ç»ƒï¼‰ï¼Œæˆ–è€…ï¼Œé¢„æµ‹ä»x(t)åˆ°x(t-1)åº”è¯¥ç§»é™¤çš„å™ªå£°ï¼ˆæ¨ç†ï¼‰ã€‚
- Diffusionå¦‚ä½•åœ¨Alphafold3ä¸­è¿›è¡Œåº”ç”¨ï¼Ÿ
    
    ![image.png](images/image%2050.png)
    
    - åœ¨Alphafold3ä¸­ï¼Œç”¨äºå»å™ªçš„åŸå§‹æ•°æ®ä¸ºä¸€ä¸ªçŸ©é˜µxï¼Œå®ƒçš„ç»´åº¦ä¸º[N_atoms, 3]ï¼Œå…¶ä¸­3æ˜¯æ¯ä¸€ä¸ªåŸå­çš„åæ ‡xyzã€‚
    - åœ¨è®­ç»ƒçš„æ—¶å€™ï¼Œæ¨¡å‹ä¼šåŸºäºä¸€ä¸ªæ­£ç¡®çš„çš„åŸå­ä¸‰ç»´åæ ‡åºåˆ—xï¼Œåœ¨æ¯ä¸€æ­¥è¿›è¡Œé«˜æ–¯å™ªå£°çš„æ·»åŠ ï¼Œç›´åˆ°å…¶åæ ‡å®Œå…¨éšæœºã€‚
    - ç„¶ååœ¨æ¨ç†çš„æ—¶å€™ï¼Œæ¨¡å‹ä¼šä»ä¸€ä¸ªå®Œå…¨éšæœºçš„åŸå­ä¸‰ç»´åæ ‡åºåˆ—å‡ºå‘ï¼Œåœ¨æ¯ä¸€ä¸ªæ—¶é—´æ­¥ï¼Œé¦–å…ˆä¼šè¿›è¡Œä¸€ä¸ªdata-augmentationçš„æ“ä½œï¼Œå¯¹ä¸‰ç»´åæ ‡è¿›è¡Œæ—‹è½¬å’Œå˜æ¢ï¼Œç›®çš„æ˜¯ä¸ºäº†å®ç°åœ¨AF2ä¸­çš„Invariant Point Attention(IPA)çš„åŠŸèƒ½ï¼Œè¯æ˜ç»è¿‡æ—‹è½¬å’Œå˜æ¢ä¹‹åçš„ä¸‰ç»´åæ ‡æ˜¯ç›¸äº’ç­‰ä»·çš„ï¼Œç„¶åä¼šå†å‘åæ ‡åŠ å…¥ä¸€äº›å™ªå£°æ¥å°è¯•äº§ç”Ÿä¸€äº›ä¸åŒçš„ç”Ÿæˆæ•°æ®ï¼Œæœ€åï¼Œé¢„æµ‹å½“å‰æ—¶é—´æ­¥é™å™ªä¹‹åçš„ç»“æœä½œä¸ºä¸‹ä¸€æ­¥çš„èµ·ç‚¹ã€‚
    
    ![image.png](images/image%2051.png)
    

## Structure Prediction è¯¦è§£

![image.png](images/image%2052.png)

### Sample Diffusionéƒ¨åˆ†è¯¦è§£ï¼ˆæ¨ç†è¿‡ç¨‹ï¼‰

- åŸºæœ¬çš„æ‰©æ•£è¿‡ç¨‹åœ¨alphafold3ä¸­çš„åº”ç”¨ï¼Œè¿™é‡Œæ˜¯æŒ‡çš„diffusionæ¨¡å‹çš„æ¨ç†è¿‡ç¨‹åœ¨alphafold3çš„æ¨ç†è¿‡ç¨‹ä¸­çš„å…·ä½“ç®—æ³•æµç¨‹ï¼Œä»åˆå§‹çŠ¶æ€ï¼ˆå®Œå…¨éšæœºçš„ä¸‰ç»´ç»“æ„ï¼‰ï¼Œç„¶åç»è¿‡ä¸€æ­¥ä¸€æ­¥åœ°å»å™ªï¼Œæœ€ç»ˆè¿”å›ä¸€ä¸ªå»å™ªä¹‹åçš„ç»“æœï¼ˆé¢„æµ‹çš„ä¸‰ç»´ç»“æ„ï¼‰ã€‚
- å…·ä½“çš„ç®—æ³•ä¼ªä»£ç ä»¥åŠè§£æå¦‚ä¸‹æ‰€ç¤ºï¼š
    
    ![image.png](images/image%2053.png)
    
    - é¦–å…ˆå®ƒçš„è¾“å…¥å‚æ•°åŒ…æ‹¬äº†å¾ˆå¤šåç»­ç”¨äºconditional diffusionçš„è¾“å…¥ï¼ŒåŒ…æ‹¬f*ï¼Œ{s_inputs_i}, {s_trunk_i}, {z_trunk_i_j} ï¼Œè¿™äº›åç»­ä¸»è¦åœ¨DiffusionModuleè¿™ä¸ªç®—æ³•ä¸­è¿›è¡Œå¤„ç†ï¼Œè¿™é‡Œæš‚æ—¶å¿½ç•¥ä¸è®¨è®ºã€‚
    - å…¶ä»–çš„è¾“å…¥ä¸»è¦æ˜¯diffusionç®—æ³•ä¸­æ‰€éœ€è¦å…³æ³¨çš„è¾“å…¥ï¼ŒåŒ…æ‹¬Noise Schedule $[c_0, c_1, ..., c_T]$ï¼Œç¼©æ”¾å› å­( $Î³_0$ å’Œ $Î³_{min}$)ï¼Œå™ªå£°ç¼©æ”¾ç³»æ•° noise_scale $Î»$ ï¼Œå’Œæ­¥é•¿ç¼©æ”¾ç³»æ•° step_scale Î·**ã€‚**ä»–ä»¬çš„å…·ä½“ä½œç”¨ä»‹ç»å¦‚ä¸‹ï¼š
        - Noise Schedule(å™ªå£°è°ƒåº¦è¡¨)ï¼šå®šä¹‰äº†æ‰©æ•£è¿‡ç¨‹ä¸­æ¯ä¸€æ­¥çš„å™ªå£°å¼ºåº¦ï¼Œå–å€¼èŒƒå›´æ˜¯[0,1]ä¹‹é—´ï¼Œå®ƒæ˜¯é¢„å…ˆè®¾å®šå¥½çš„ä¸€ç³»åˆ—æ ‡é‡ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå™ªå£°å¼ºåº¦ä»t=0æ—¶å€™ä¸ºæœ€å¤§ï¼Œç„¶åæ…¢æ…¢å‡å°ï¼Œåˆ°è¾ƒå°çš„t=Tæ—¶å€™ç»“æŸã€‚
        - ç¼©æ”¾å› å­( $Î³_0$ å’Œ $Î³_{min}$)ï¼Œå™ªå£°ç¼©æ”¾ç³»æ•° noise_scale $Î»$ ï¼Œéƒ½æ˜¯ç”¨åœ¨Sample Diffusionçš„æ¨ç†æ¯ä¸€æ­¥å¼€å§‹æ—¶ï¼Œéœ€è¦ç»™ä¸Šä¸€ä¸ªstepçš„è¿­ä»£ç»“æœå…ˆæ·»åŠ å™ªå£°ï¼Œç”Ÿæˆå™ªå£° $\hat\xi_l$ çš„ä½œç”¨ã€‚
        - æ­¥é•¿ç¼©æ”¾ç³»æ•° step scale Î·ï¼šä¸»è¦æ˜¯ç”¨äºåœ¨åç»­x_lè¿›è¡Œæ›´æ–°çš„æ—¶å€™ï¼Œæ§åˆ¶æ¯ä¸€æ­¥è¿­ä»£ä¸­è¾“å…¥æ›´æ–°çš„å¹…åº¦ï¼Œåœ¨x_lè¿›è¡Œæ›´æ–°çš„è¿‡ç¨‹ä¸­ $\vec{x}_l \leftarrow \vec{x}_l^{\text{noisy}} + \eta \cdot dt \cdot \vec{\delta}_l$ ï¼šå¦‚æœÎ· > 1 åˆ™å¢å¤§æ›´æ–°å¹…åº¦ï¼ŒåŠ å¿«å»å™ªè¿‡ç¨‹ï¼›å¦‚æœÎ· < 1 åˆ™å‡å°æ›´æ–°å¹…åº¦ï¼Œä½¿å¾—å»å™ªè¿‡ç¨‹æ›´å¹³æ»‘ï¼Œä½†æ˜¯å¯èƒ½éœ€è¦æ›´å¤šè¿­ä»£æ­¥æ•°ã€‚
    - å…·ä½“çš„ç®—æ³•æµç¨‹è§£æå¦‚ä¸‹ï¼š
        1. æœ€åˆçš„æ—¶å€™ï¼Œ $\vec{x}_l$Â æ˜¯å®Œå…¨éšæœºçš„ä¸‰ç»´å™ªå£°ï¼Œç»´åº¦æ˜¯[3]ï¼Œ{$\vec{x}_l$ }çš„ç»´åº¦æ˜¯[N_atoms, 3]ã€‚å…¶ä¸­ $\mathcal{N}(\vec{0}, \mathbf{I}_3)$ æ˜¯å¤šç»´æ­£æ€åˆ†å¸ƒï¼Œå‡å€¼ä¸ºä¸‰ç»´å‘é‡ [0,0,0], è¡¨ç¤ºä¸‰ä¸ªç»´åº¦çš„å‡å€¼éƒ½æ˜¯0ï¼›åæ–¹å·®çŸ©é˜µä¸º[1, 0, 0; 0, 1, 0; 0, 0, 1]ï¼Œè¡¨ç¤ºå„ä¸ªç»´åº¦ä¹‹é—´ç›¸äº’ç‹¬ç«‹ä¸”æ–¹å·®éƒ½ä¸º1.
        2. æ¥ä¸‹æ¥è¿›å…¥æ¯ä¸€ä¸ªæ—¶é—´æ­¥çš„å¾ªç¯ï¼Œä» $\tau=1$ å¼€å§‹ç›´åˆ° $\tau=T$ï¼š
        3. é¦–å…ˆè¿›è¡Œä¸€æ¬¡æ•°æ®å¢å¼ºï¼Œè¿™é‡Œçš„ç›®çš„æ˜¯ä¸ºäº†è§£å†³ä¹‹å‰Alphafold2ä¸­ä½¿ç”¨Invariant Point Attentionæ–¹æ³•è¦å»è§£å†³çš„é—®é¢˜ï¼Œå³è§£å†³æ—‹è½¬ä¸å˜æ€§å’Œå¹³ç§»ä¸å˜æ€§ï¼Œå³ä¸€ä¸ªåºåˆ—çš„ä¸‰ç»´ç»“æ„çš„åæ ‡é€šè¿‡éšæœºæ—‹è½¬å’Œå¹³ç§»åå®é™…ä¸Šå¾—åˆ°çš„æ–°çš„åæ ‡æ˜¯ç­‰ä»·çš„ï¼Œä¸‰ç»´ç»“æ„æœ¬è´¨ä¸å˜ï¼ŒåŸå­å’ŒåŸå­ä¹‹é—´çš„ç›¸å¯¹ä½ç½®ä¸å˜ã€‚
        4. ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ$c_\tau < \gamma_{\text{min}}$ï¼Œå› ä¸ºè¿™é‡Œçš„ $\gamma_{\text{min}} = 1$ï¼Œæ‰€ä»¥ $\gamma=0$.
        5. æ‰€ä»¥ï¼Œè¿™é‡Œçš„æ—¶é—´æ­¥ $\hat{t} = c_{\tau-1}$ã€‚
        6. è®¡ç®—å¾—åˆ°çš„åŠ å™ªå£°ä¸ºï¼š $\vec{\xi}_l = 0*(\vec{0}, \mathbf{I}_3)$ï¼Œå¹¶æ²¡æœ‰åŠ ä»€ä¹ˆå™ªå£°ã€‚
        7. äºæ˜¯å¾—åˆ°åŠ äº†å™ªå£°æœ€åçš„ $\vec{x}_l^{\text{noisy}} = \vec{x}_l$
        8. è¿™æ—¶å€™è°ƒç”¨DiffusionModuleï¼ˆä¸‹ä¸€é˜¶æ®µä¼šè¯¦è§£ï¼‰è®¡ç®—çœŸæ­£æ­¤æ­¥æ¨ç†çš„ç»“æœï¼Œå¾—åˆ°å»å™ªä¹‹åçš„ç»“æœ $\{\vec{x}_l^{\text{denoised}}\}$ã€‚
        9. ç„¶åå¼€å§‹è®¡ç®—å»å™ªæ–¹å‘çš„å‘é‡ $\vec{\delta}_l = \frac{\left( \vec{x}_l^{\text{noisy}} - \vec{x}_l^{\text{denoised}} \right)}{\hat{t}}$ï¼Œå³åŠ å™ªå£°åæ ‡ $\vec{x}_l^{{noisy}}$è·ç¦»å»å™ªåæ ‡ $\vec{x}_l^{\text{denoised}}$çš„æ–¹å‘å’Œå¹…åº¦ï¼Œç„¶åè¿›è¡Œå™ªå£°å½’ä¸€åŒ–ï¼Œä½¿å¾—å»å™ªæ–¹å‘åœ¨æ¯ä¸€ä¸ªæ—¶é—´æ­¥çš„å™ªå£°å¼ºåº¦å˜åŒ–ä¸­ä¿æŒç¨³å®šã€‚å¯ä»¥å°†å…¶ç†è§£ä¸ºæ‰©æ•£è¿‡ç¨‹ä¸­ç±»ä¼¼äºâ€æ¢¯åº¦â€œæˆ–è€…â€œæ–¹å‘å¯¼æ•°â€
        10. ç„¶åè®¡ç®—æ—¶é—´æ­¥å·®å€¼dtï¼Œå½“å‰æ—¶é—´æ­¥å’Œä¹‹å‰æ—¶é—´æ­¥çš„å·®å€¼ï¼Œä¸ºæ›´æ–°æä¾›äº†ä¸€ä¸ªâ€œæ­¥é•¿â€ï¼Œä» $c_\tau$åˆ°å‰ä¸€ä¸ªæ—¶é—´æ­¥å‚æ•° $\hat{t}$ çš„å·®å€¼ï¼Œè¿™é‡Œå®é™…ä¸Šæ­£å¥½å°±æ˜¯ $dt = c_\tau - c_{\tau-1}$ã€‚
        11. æœ€åï¼Œæ›´æ–° $\vec{x}_l$ï¼Œä»åŠ å™ªå£°çš„åæ ‡å¼€å§‹ $\vec{x}_l^{\text{noisy}}$ å…¶å®è¿™é‡Œå°±æ˜¯ $\vec{x}_l=\vec{x}_l+\eta \cdot dt \cdot \vec{\delta}_l$
         ã€‚ç”±äºè¿™é‡Œdtå¤§æ¦‚ç‡æ˜¯ä¸€ä¸ªè´Ÿæ•°ï¼Œæ‰€ä»¥å®é™…ä¸Šæ˜¯å‡å»å™ªå£°ã€‚

### Diffusion Moduleéƒ¨åˆ†è¯¦è§£ï¼ˆæ¨ç†è¿‡ç¨‹ï¼‰

![image.png](images/image%2054.png)

- **DiffusionConditioning** : å‡†å¤‡token-levelçš„ conditioning tensors ( pairè¡¨å¾ z_i_j å’Œ single è¡¨å¾ s_i )
- **AtomAttentionEncoder** :  å‡†å¤‡atom-levelçš„conditioning tensors (pair è¡¨å¾ p_l_m, singleè¡¨å¾ q_l, c_l)ï¼ŒåŒæ—¶ä½¿ç”¨å…¶ç”Ÿæˆtoken-levelçš„ single è¡¨å¾ a_iã€‚
- **DiffusionTransformers**ï¼štoken-levelçš„singleè¡¨å¾ a_i ç»è¿‡attentionè®¡ç®—ï¼Œç„¶åæ˜ å°„å› atom-levelã€‚
- **AtomAttentionDecoderï¼š**åœ¨atom-levelä¸Šè¿›è¡Œattentionè®¡ç®—ï¼Œå¾—åˆ°é¢„æµ‹çš„atom-levelçš„é™å™ªç»“æœã€‚

æ³¨1ï¼šè¿™é‡ŒAtom-levelçš„attentionéƒ½è¢«ä½œè€…æ ‡æ³¨ä¸ºlocal attentionï¼Œtoken-levelçš„attentionéƒ½è¢«ä½œè€…æ ‡æ³¨ä¸ºglobal attentionï¼ŒåŸå› åœ¨äºåŸå­çš„æ•°é‡éå¸¸å¤§ï¼Œåœ¨è®¡ç®—åŸå­åºåˆ—ä¹‹é—´çš„attentionçš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯è®¡ç®—AtomTransformerçš„æ—¶å€™ï¼Œå®é™…ä¸Šéƒ½æ˜¯è®¡ç®—çš„ç¨€ç–æ³¨æ„åŠ›ï¼Œè·ç¦»å½“å‰çš„queryåŸå­è·ç¦»è¿‡è¿œçš„å…¶ä»–åŸå­å¹¶ä¸å‚ä¸å½“å‰åŸå­çš„attentionè®¡ç®—ï¼Œå¦åˆ™è®¡ç®—é‡ä¼šéå¸¸å¤§ï¼Œæ‰€ä»¥å®ƒå«åšlocal attentionã€‚è€Œåœ¨token-levelçš„attentionè®¡ç®—çš„æ—¶å€™ï¼Œåˆ™æ˜¯è€ƒè™‘äº†æ•´ä¸ªå…¨å±€çš„æ‰€æœ‰tokençš„ä¿¡æ¯ï¼Œæ‰€ä»¥å«åšglobal attentionã€‚

æ³¨2ï¼šè¿™é‡Œçš„AtomAttentionEncoderä¸­ 3 blocks å’ŒAtomAttentionDecoder ä¸­çš„ 3 blocksï¼ŒæŒ‡çš„å°±æ˜¯AtomTransformerï¼Œæœ¬è´¨ä¸Šæ˜¯åŠ ä¸Šç¨€ç–åç½®ä¹‹åçš„åœ¨åŸå­ç²’åº¦ä¸Šçš„DiffusionTransformerï¼Œè€Œåœ¨tokenç²’åº¦ä¸Šçš„DiffusionTransformeræ˜¯24ä¸ªblocksã€‚

1. **DiffusionConditioning**
    - ç®—æ³•ä¼ªä»£ç å¦‚ä¸‹ï¼š
        
        ![image.png](images/image%2055.png)
        
    - æ„å»ºtoken-levelçš„pair conditioning input: {z_i_j}
        
        ![image.png](images/image%2056.png)
        
        1. é¦–å…ˆåˆ©ç”¨f*è®¡ç®—ç›¸å¯¹ä½ç½®ç¼–ç ï¼Œè¿™ä¸ªç›¸å¯¹ä½ç½®ç¼–ç æ˜¯(i,j)çš„å‡½æ•°ï¼Œä»£è¡¨ä»»æ„ä¸¤ä¸ªtokenä¹‹é—´çš„ç›¸å¯¹ä½ç½®å…³ç³»ï¼Œå¾—åˆ°ç»“æœçš„ç»´åº¦æ˜¯c_zï¼›å’Œz_trunk_i_jï¼ˆç»´åº¦ä¹Ÿæ˜¯c_z)è¿›è¡Œæ‹¼æ¥ï¼Œå¾—åˆ°z_i_j,ç»´åº¦æ˜¯2*c_zã€‚
        2. ç„¶åå°†z_i_jè¿›è¡ŒlayerNormï¼Œä¹‹åå†è¿›è¡Œçº¿æ€§å˜æ¢ï¼Œå˜æ¢åˆ°c_zçš„ç»´åº¦ä¸Šã€‚
        3. æœ€åç»è¿‡ä¸¤æ¬¡Transition Layerçš„åŠ åˆï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„z_i_jã€‚
    - æ„å»ºtoken-levelçš„single conditioning input: {s_i}
        
        ![image.png](images/image%2057.png)
        
        1. é¦–å…ˆå°†s_trunk_iå’Œs_inputs_iè¿™ä¸¤ä¸ªsingle representationæ‹¼æ¥èµ·æ¥ï¼Œå¾—åˆ°s_iï¼Œç»´åº¦å˜æˆ2*c_s+65ï¼ˆs_inputs_içš„ç»´åº¦ä¸ºc_s+65ï¼‰ã€‚
        2. ç„¶åå¯¹s_iè¿›è¡Œå½’ä¸€åŒ–ï¼Œç„¶åè¿›è¡Œçº¿æ€§å˜æ¢ï¼Œç»´åº¦å˜æˆc_sã€‚
        3. ç„¶åå¯¹diffusionçš„æ—¶é—´æ­¥é•¿ï¼ˆå…·ä½“å®é™…ä¸Šå°±æ˜¯å½“å‰æ—¶é—´æ­¥çš„noise scheculeçš„å€¼ï¼‰ä¿¡æ¯ï¼ˆæ ‡é‡ï¼‰ï¼Œå°†å…¶æ˜ å°„åˆ°é«˜ç»´å‘é‡ç©ºé—´ï¼Œä»¥å¢å¼ºæ¨¡å‹æ•è·æ—¶é—´æ­¥é•¿éçº¿æ€§ç‰¹å¾çš„èƒ½åŠ›ã€‚
            1. å…·ä½“çš„ä¼ªä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š
                
                ![image.png](images/image%2058.png)
                
                1. ç”Ÿæˆcç»´åº¦çš„å‘é‡ï¼Œæ¯ä¸€ç»´éƒ½æ˜¯ç‹¬ç«‹æ­£æ€åˆ†å¸ƒï¼Œå¾—åˆ°wå’Œbã€‚
                2. ç”Ÿæˆæ—¶é—´æ­¥çš„é«˜ç»´åº¦å‘é‡ç‰¹å¾ï¼Œé€šè¿‡coså‡½æ•°å°†æ ‡é‡æ—¶é—´æ­¥é•¿tç¼–ç åˆ°ä¸€ä¸ªé«˜ç»´ç©ºé—´ä¸­ï¼Œå…·ä½“ç”Ÿæˆçš„å‘é‡å¯ä»¥ç†è§£ä¸ºå¦‚ä¸‹å›¾ï¼ˆxä¸ºæ—¶é—´æ­¥tï¼Œyçš„ä¸åŒå€¼ä¸ºå…¶åœ¨é«˜ç»´ç©ºé—´çš„å‘é‡ï¼‰æ‰€ç¤ºï¼Œæ¯ä¸€ä¸ªtåˆ‡é¢å°±æ˜¯ä¸€ä¸ªtæ—¶åˆ»çš„é«˜ç»´å‘é‡ã€‚
                    
                    ![image.png](images/image%2059.png)
                    
                    - ä¸åŒçš„é¢‘ç‡æ•æ‰äº†æ—¶é—´æ­¥é•¿çš„å¤šå°ºåº¦ç‰¹å¾ï¼ˆä½é¢‘è¡¨ç¤ºå…¨å±€åŠ¨æ€ï¼Œé«˜é¢‘è¡¨ç¤ºå±€éƒ¨ç»†èŠ‚ï¼‰
                    - åç§»é‡å¢åŠ äº†åµŒå…¥çš„å¤šæ ·æ€§ï¼Œä½¿æ¨¡å‹èƒ½å­¦ä¹ åˆ°æ›´å¤æ‚çš„æ—¶é—´ç‰¹å¾ã€‚
            
            1. å°†é«˜ç»´æ—¶é—´æ­¥ä¿¡æ¯å…ˆè¿›è¡Œå½’ä¸€åŒ–ï¼Œç„¶åè¿›è¡Œçº¿æ€§å˜åŒ–å (n â†’ c_s)ï¼ŒåŠ å…¥åˆ°token-level çš„ single è¡¨å¾s_iä¸­å»äº†ã€‚
            2. å†ç»è¿‡ä¸¤æ¬¡Transition layerçš„åŠ åˆï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„s_i ï¼Œç»´åº¦ä¸ºc_sã€‚
    - é€šè¿‡åœ¨æ­¤DiffusionConditionéƒ¨åˆ†åŠ å…¥diffusionæ—¶é—´æ­¥ä¿¡æ¯ï¼Œä½¿å¾—æ¨¡å‹åœ¨è¿›è¡Œde-noisingè¿‡ç¨‹ä¸­èƒ½å¤ŸçŸ¥é“å½“å‰diffusionè¿‡ç¨‹çš„æ—¶é—´æ­¥ï¼Œå¹¶ä¸”é¢„æµ‹å‡ºéœ€è¦å»æ‰çš„æ­£ç¡®å°ºåº¦çš„å™ªå£°ã€‚
    - ç»è¿‡DiffusionConditionçš„ç»“æœæ˜¯åœ¨token-levelå°ºåº¦ä¸Šçš„ä¿¡æ¯ï¼Œæ¥ä¸‹æ¥éœ€è¦åœ¨atom-levelè®¡ç®—åŸå­çº§åˆ«çš„ä¿¡æ¯ã€‚
2. **AtomAttentionEncoder**
    - é¦–å…ˆå°†x_noisy_l è¿›è¡Œç¼©æ”¾ï¼Œè½¬æ¢ä¸ºå•ä½æ–¹å·®ä¸º1çš„å•ä½å‘é‡ï¼Œå…¶ç¼©æ”¾åçš„ç»“æœæ˜¯ä¸€ä¸ªæ— é‡çº²çš„æ•°å€¼ï¼Œä¾¿äºä¿æŒæ•°å€¼çš„ç¨³å®šæ€§ã€‚
        
        ![image.png](images/image%2060.png)
        
    - ç„¶åæ­£å¼è¿›å…¥AtomAttentionEncoderå‡½æ•°è¿›è¡Œè®¡ç®—ï¼š
        
        ![image.png](images/image%2061.png)
        
        - AtomAttentionEncoderçš„è¾“å…¥åŒ…æ‹¬ï¼š{f*}(åŸå§‹ç‰¹å¾å‚è€ƒæ„è±¡ç‰¹å¾), {r_noisy_l}(åŠ å…¥å½“å‰å™ªå£°çš„å½“å‰æ—¶é—´æ­¥åŸå­åæ ‡), {s_trunk_i}(ç»è¿‡Pairformerçš„token-level singleè¡¨å¾) , {z_i_j}(ç»è¿‡DiffusionConditioningä¹‹åçš„token-levelçš„Pair è¡¨å¾)
        - AtomAttentionEncoderçš„è¾“å‡ºåŒ…æ‹¬ï¼ša_i(token-levelçš„singleè¡¨å¾)ï¼Œq_l(æœ¬æ¨¡å—è®¡ç®—å¾—åˆ°çš„atom-levelçš„singleè¡¨å¾)ï¼Œc_l(åŸºäºå‚è€ƒæ„è±¡è·å–çš„atom-levelçš„åˆå§‹è¡¨å¾)ï¼Œ p_l_m(æœ¬æ¨¡å—è®¡ç®—å¾—åˆ°çš„atom-levelçš„pairè¡¨å¾)ã€‚
        - AtomAttentionEncoderçš„ä¼ªä»£ç å¦‚ä¸‹ï¼šï¼ˆdiffusionæ–°å¢çš„éƒ¨åˆ†çªå‡ºæ˜¾ç¤ºï¼‰
            
            ![image.png](images/image%2062.png)
            
            - é¦–å…ˆï¼Œä»åŸå§‹å‚è€ƒæ„è±¡è¡¨å¾ä¸­è®¡ç®—å¾—åˆ°c_lï¼Œå¹¶å°†q_lçš„åˆå§‹å€¼è®¾å®šä¸ºc_lï¼Œç„¶åç„¶åä»å‚è€ƒæ„è±¡è¡¨å¾ä¸­è®¡ç®—atom-levelçš„pairè¡¨å¾p_l_mã€‚
            - æ¥ç€ï¼Œç„¶åå•r_lä¸ä¸ºç©ºçš„æ—¶å€™ï¼ˆå°±æ˜¯å½“å‰diffusionéƒ¨åˆ†çš„æ¨ç†è¿‡ç¨‹æ—¶ï¼‰ï¼š
                - ä½¿ç”¨s_trunkè¿™ä¸ªtoken-levelçš„singleç‰¹å¾ï¼Œè·å–å…¶åœ¨atomåºå·lå¯¹åº”çš„tokenåºå·tok_idx(l)ï¼Œç„¶åè·å–è¿™ä¸ªtokenåºå·å¯¹åº”çš„s_trunkçš„å‘é‡ï¼Œç»´åº¦ä¸ºc_s(c_token)ï¼Œç„¶åè¿›è¡ŒLayerNormä¹‹åï¼Œè¿›è¡Œçº¿æ€§å˜æ¢ï¼Œç»´åº¦ä»c_s â†’ c_atomã€‚ç„¶åå†åŠ ä¸Šc_læœ¬èº«ï¼Œå¾—åˆ°æ–°çš„c_lï¼Œå…·ä½“è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š
                    
                    ![image.png](images/image%2063.png)
                    
                - ä½¿ç”¨zè¿™ä¸ªtoken-levelçš„pairç‰¹å¾ï¼Œè·å–atomåºå·lå’Œmçš„å¯¹åº”çš„tokenåºå·tok_idx(l)å’Œtok_idx(m)ï¼Œç„¶åè·å–è¿™ä¸ªä¸¤ä¸ªç»´åº¦åºå·å¯¹åº”çš„zçš„å‘é‡ï¼Œç»´åº¦ä¸ºc_z,ç„¶åè¿›è¡ŒLayerNormä¹‹åï¼Œè¿›è¡Œçº¿æ€§å˜æ¢ï¼Œç»´åº¦ä»c_z â†’ c_atompairã€‚æœ€åå†åŠ ä¸Šp_l_mæœ¬èº«ï¼Œå¾—åˆ°æ–°çš„p_l_mï¼Œå…·ä½“è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š
                    
                    ![image.png](images/image%2064.png)
                    
                - é’ˆå¯¹åŠ å…¥å½“å‰å™ªå£°çš„å½“å‰æ—¶é—´æ­¥åŸå­åæ ‡r_noisy_lï¼Œå°†å…¶è¿›è¡Œçº¿æ€§å˜æ¢ä¹‹åï¼Œç»´åº¦å˜æ¢3â†’c_atomï¼ŒåŠ åˆåˆ°q_lä¸Šï¼Œå¾—åˆ°æœ€æ–°çš„q_lç»“æœã€‚
            - æœ€åï¼ŒåŸºäºc_lå¯¹p_l_mçš„ç»“æœè¿›è¡Œæ›´æ–°ï¼Œå°†p_l_mç»è¿‡3å±‚MLPå¾—åˆ°è¡ŒåŠ¨p_l_mï¼Œç„¶åé€šè¿‡AtomTransformerè®¡ç®—å¾—åˆ°æœ€æ–°çš„q_lï¼Œæœ€åå°†q_lè¿™ä¸ªatom-levelçš„singleè¡¨å¾ï¼Œåœ¨ä¸åŒçš„tokenç»´åº¦ä¸Šæ±‚å¹³å‡ï¼Œå¾—åˆ°a_iï¼ˆtoken-level çš„singleè¡¨å¾ï¼‰çš„ç»“æœã€‚äºæ˜¯ï¼Œé€šè¿‡AtomAttentionEncoderå°±å¾—åˆ°ä»¥ä¸‹ç»“æœï¼š
                - {q_l}ï¼šæ›´æ–°ä¹‹åçš„atom-levelçš„singleè¡¨å¾ï¼ŒåŒ…å«äº†å½“å‰atomçš„åæ ‡ä¿¡æ¯ã€‚
                - {c_l}ï¼šatom-levelçš„singleè¡¨å¾ï¼ŒåŸºäºPairformerçš„token-level singleè¡¨å¾æ›´æ–°è¿‡çš„å˜é‡ï¼Œä¸»è¦èµ·çš„ä½œç”¨æ˜¯åŸºäºTrunkè¿›è¡Œconditioningã€‚
                - {p_l_m}: atom-levelçš„pairè¡¨å¾ï¼Œç”¨äºåç»­çš„diffusionçš„conditioningã€‚
                - {a_i}ï¼štoken-levelçš„singleè¡¨å¾ï¼Œä»q_lä¸­èšåˆè€Œæ¥ã€‚åŒæ—¶åŒ…å«äº†atom-levelçš„åæ ‡ä¿¡æ¯å’Œtoken-levelçš„åºåˆ—ä¿¡æ¯ã€‚
3. **DiffusionTransformers**
    - å…·ä½“çš„ä¼ªä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼šè¿™ä¸€éƒ¨åˆ†ä¸»è¦æ˜¯å¯¹ä¸Šä¸€æ­¥è®¡ç®—å‡ºæ¥çš„token-levelçš„ä¿¡æ¯a_iï¼ˆå…¶åŒ…å«äº†åŸå­ä¸‰ç»´åæ ‡ä¿¡æ¯å’Œåºåˆ—ä¿¡æ¯ï¼‰è¿›è¡Œself-attentionã€‚
        
        ![image.png](images/image%2065.png)
        
        - é¦–å…ˆï¼Œå¯¹ä»**DiffusionConditioning**è®¡ç®—å¾—åˆ°çš„token-level singleè¡¨å¾{s_i}å‡ºå‘ï¼Œè®¡ç®—å®ƒçš„LayerNormç»“æœä¹‹åï¼Œåœ¨è¿›è¡Œçº¿æ€§å˜æ¢ï¼Œå°†å…¶å˜æ¢åˆ°a_içš„ç»´åº¦ï¼Œçº¿æ€§å˜æ¢ç»´åº¦ä¸º c_token â†’ c_sï¼Œç„¶ååœ¨åŠ ä¸Š{a_i}æœ¬èº«è¿›è¡Œelement-wise addï¼Œå¾—åˆ°æ–°çš„{a_i}ã€‚
        - ç„¶åï¼Œå¯¹token-levelçš„ä¿¡æ¯{a_i}è¿›è¡Œattentionï¼Œå¹¶ä¸”ä½¿ç”¨ä»DiffusionConditioningè®¡ç®—å¾—åˆ°çš„{s_i}å’Œ{z_i_j}è¿›è¡Œconditioningï¼Œæ³¨æ„è¿™é‡Œçš„DiffusionTransformerå’Œåœ¨ä¹‹å‰çš„æ‰€æœ‰DiffusionTransformerçš„ä¸€ä¸ªå¤§çš„åŒºåˆ«æ˜¯ï¼Œè¿™é‡Œæ˜¯é’ˆå¯¹token-levelçš„ï¼ˆToken-level equivalent of the atom transformerï¼‰ï¼Œæ‰€ä»¥è¿™é‡Œçš„ $\beta_{ij} = 0$ è¡¨ç¤ºä¸åŠ å…¥ç¨€ç–attentionçš„åç½®ã€‚ä¸‹é¢ä¹Ÿç»™å‡ºä¸€ä¸ªç¤ºæ„å›¾ï¼š
            
            ![image.png](images/image%2066.png)
            
        - æœ€åï¼Œa_iç»è¿‡ä¸€ä¸ªLayerNormå¹¶è¿›è¡Œè¾“å‡ºï¼Œç»´åº¦ä¸º c_tokenã€‚
4. **AtomAttentionDecoder**
    
    ä¼ªä»£ç å¦‚ä¸‹ï¼š
    
    ![image.png](images/bed1bf65-6bec-4b73-acf5-b2cba14de665.png)
    
    - ç°åœ¨ï¼Œæˆ‘ä»¬è¿”å›åˆ°Atomç©ºé—´ï¼Œä½¿ç”¨æ›´æ–°ä¹‹åçš„ a_i æ¥å°†å…¶å¹¿æ’­åˆ°æ¯ä¸€ä¸ªatomä¸Šï¼Œä»¥æ›´æ–°atom-levelçš„singleè¡¨å¾ q_lã€‚
        
        ![image.png](images/image%2067.png)
        
    - ç„¶åï¼Œä½¿ç”¨Atom Transformeræ¥æ›´æ–°q_lã€‚
        
        ![image.png](images/image%2068.png)
        
    - æœ€åï¼Œå°†æ›´æ–°åçš„q_lç»è¿‡LayerNormå’Œçº¿æ€§å˜æ¢ä¹‹åï¼Œæ˜ å°„åˆ°åŸå­åºåˆ—çš„ä¸‰ç»´åæ ‡ä¸Šï¼Œå¾—åˆ°r_update_lã€‚
        
        ![image.png](images/image%2069.png)
        
    - æœ€åçš„æœ€åï¼Œåœ¨AtomAttentionDecoderä¹‹å¤–ï¼Œå°†â€œæ— é‡çº²ï¼ˆdimensionlesï¼‰â€çš„r_update_lï¼Œé‡æ–°rescaleåˆ°éå•ä½æ ‡å‡†å·®çš„ x_out_lä¸Šå»ï¼Œè¿”å›çš„å°±æ˜¯x_denoised_lã€‚
        
        ![image.png](images/image%2070.png)
        
    

# Loss Function

æœ€ç»ˆçš„LossFunctionçš„å…¬å¼å¦‚ä¸‹ï¼š

$\mathcal{L}\_{\text{loss}} = \alpha\_{\text{confidence}} \cdot L\_{\text{confidence}} + \alpha\_{\text{diffusion}} \cdot \mathcal{L}\_{\text{diffusion}} + \alpha\_{\text{distogram}} \cdot \mathcal{L}\_{\text{distogram}}$

å…¶ä¸­ï¼Œ $L\_{confidence}= \mathcal{L}\_{\text{plddt}} + \mathcal{L}\_{\text{pde}} + \mathcal{L}\_{\text{resolved}} + \alpha\_{\text{pae}} \cdot \mathcal{L}\_{\text{pae}}$

$\mathcal{L}\_{\text{loss}} = \alpha\_{\text{confidence}} \cdot \left( \mathcal{L}\_{\text{plddt}} + \mathcal{L}\_{\text{pde}} + \mathcal{L}\_{\text{resolved}} + \alpha\_{\text{pae}} \cdot \mathcal{L}\_{\text{pae}} \right) + \alpha\_{\text{diffusion}} \cdot \mathcal{L}\_{\text{diffusion}} + \alpha\_{\text{distogram}} \cdot \mathcal{L}\_{\text{distogram}}$

- L_distogram: ç”¨äºè¯„ä¼°é¢„æµ‹å‡ºæ¥çš„ token-level çš„ distogramï¼ˆä¹Ÿå°±æ˜¯token-tokenä¹‹é—´çš„è·ç¦»ï¼‰æ˜¯å¦å‡†ç¡®ã€‚
- L_diffusion: ç”¨äºè¯„ä¼°é¢„æµ‹å‡ºæ¥atom-level çš„ distogram ï¼ˆä¹Ÿå°±æ˜¯atom-atomä¹‹é—´çš„å…³ç³»ï¼‰æ˜¯å¦å‡†ç¡®ï¼ŒåŒæ—¶è¿˜åŒ…å«äº†ä¸€äº›é¢å¤–çš„termsï¼ŒåŒ…æ‹¬ä¼˜å…ˆè€ƒè™‘å°±è¿‘åŸå­ä¹‹é—´çš„å…³ç³»ä»¥åŠå¯¹è›‹ç™½è´¨-é…ä½“ä¹‹é—´çš„é”®çš„åŸå­è¿›è¡Œå¤„ç†ã€‚
- L_confidence: ç”¨äºè¯„ä¼°æ¨¡å‹çš„å…³äºå¯¹è‡ªå·±é¢„æµ‹å‡ºæ¥çš„ç»“æ„å“ªäº›æ˜¯å‡†ç¡®æˆ–è€…ä¸å‡†ç¡®çš„self-awarenessçš„å‡†ç¡®æ€§ã€‚

## $L_{distogram}$

- å°½ç®¡è¾“å‡ºçš„ç»“æœæ˜¯ä¸€ä¸ªatom-levelçš„ä¸‰ç»´åæ ‡ï¼Œä½†æ˜¯è¿™é‡Œçš„L_distogramè¿™ä¸ªlossæ˜¯ä¸€ä¸ªtoken-levelçš„æŒ‡æ ‡ï¼Œè¡¨å¾äº†æ¨¡å‹å¯¹tokenå’Œtokenä¹‹é—´çš„è·ç¦»é¢„æµ‹çš„å‡†ç¡®åº¦ï¼Œä½†æ˜¯ç”±äºå¾—åˆ°çš„æ˜¯åŸå­ä¸‰ç»´åæ ‡ï¼Œæ‰€ä»¥è¦è®¡ç®—tokençš„ä¸‰ç»´åæ ‡ï¼Œæ˜¯ç›´æ¥æ‹¿è¿™ä¸ªtokençš„ä¸­å¿ƒåŸå­çš„ä¸‰ç»´åæ ‡ä½œä¸ºtokençš„ä¸‰ç»´åæ ‡ã€‚
- ä¸ºä»€ä¹ˆæ˜¯è¦è¯„ä¼°tokenï¼ˆæˆ–è€…åŸå­ï¼‰ä¹‹é—´çš„è·ç¦»é¢„æµ‹çš„æ˜¯å¦å‡†ç¡®ï¼Œè€Œä¸æ˜¯ç›´æ¥è¯„ä¼°tokenï¼ˆæˆ–åŸå­ï¼‰çš„åæ ‡é¢„æµ‹çš„æ˜¯å¦å‡†ç¡®ï¼Ÿâ†’ æœ€æœ¬è´¨çš„åŸå› åœ¨äºtokenï¼ˆæˆ–è€…åŸå­ï¼‰çš„åæ ‡åœ¨ç©ºé—´ä¸­ç¡ç€æ•´ä¸ªç»“æ„çš„æ—‹è½¬æˆ–è€…å¹³ç§»æ˜¯å¯èƒ½æ”¹å˜çš„ï¼Œä½†æ˜¯ä»–ä»¬ä¹‹é—´çš„ç›¸å¯¹è·ç¦»æ˜¯ä¸ä¼šæ”¹å˜çš„ï¼Œè¿™æ ·çš„lossæ‰èƒ½å¤Ÿä½“ç°ç»“æ„çš„æ—‹è½¬å’Œå¹³ç§»ä¸å˜æ€§ã€‚
- å…·ä½“çš„å…¬å¼æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ
    
    $\mathcal{L}\_{\text{dist}} = -\frac{1}{N\_{\text{res}}^2} \sum_{i,j} \sum_{b=1}^{64} y\_{ij}^b \log p\_{ij}^b$
    
    - è¿™é‡Œy_b_i_jæŒ‡çš„æ˜¯å°†ç¬¬iä¸ªtokenå’Œç¬¬jä¸ªtokenä¹‹é—´çš„è·ç¦»å‡åŒ€åˆ’åˆ†åˆ°64ä¸ªæ¡¶ä¸­å»ï¼ˆä»2åŸƒåˆ°22åŸƒï¼‰ï¼Œy_b_i_jæŒ‡çš„å°±æ˜¯åœ¨è¿™64ä¸ªæ¡¶ä¸­çš„æŸä¸€ä¸ªæ¡¶ï¼Œè¿™é‡Œy_b_i_jä½¿ç”¨one-hotç¼–ç è¡¨ç¤ºå®é™…çš„ç»“æœè½åˆ°æŸä¸€ä¸ªç‰¹å®šçš„æ¡¶ä¸­ã€‚
    - p_b_i_jæŒ‡çš„æ˜¯å¯¹ç¬¬iä¸ªtokenå’Œç¬¬jä¸ªtokenä¹‹é—´çš„è·ç¦»çš„å€¼è½åˆ°æŸä¸€ä¸ªæ¡¶ä¸­çš„æ¦‚ç‡ï¼Œæ˜¯ä¸€ä¸ªsoftmaxä¹‹åçš„ç»“æœã€‚
    - å¯¹äºä»»æ„ä¸€ä¸ªtokenå¯¹ï¼ˆi,j)ï¼Œæ±‚å…¶é¢„æµ‹è·ç¦»å’Œå®é™…è·ç¦»ä¹‹é—´çš„å·®åˆ«ï¼Œé‡‡ç”¨cross-entropyçš„æ–¹å¼ï¼š
        - è®¡ç®— $\sum_{b=1}^{64} y_{ij}^b \log p_{ij}^b=\log p_{ij}^{\text{target-bin}}$
    - å¯¹äºæ‰€æœ‰çš„tokenå¯¹ï¼Œè®¡ç®—losçš„å¹³å‡å€¼ï¼š
        - è®¡ç®— $-\frac{1}{N_{\text{res}}^2} \sum_{i,j} \log p_{ij}^{\text{target-bin}}$ ï¼Œå¾—åˆ°æœ€åçš„L_distogramçš„lossçš„å€¼ã€‚

## $L_{diffusion}$

- Diffusionçš„è®­ç»ƒè¿‡ç¨‹ï¼šï¼ˆå›¾ä¸­çº¢æ¡†éƒ¨åˆ†è¡¨ç¤ºDiffusionçš„è®­ç»ƒè®¾ç½®ï¼Œè¿™å¹…å›¾è¡¨ç¤ºçš„æ˜¯AlphaFold3çš„æ€»ä½“è®­ç»ƒè®¾ç½®ï¼Œæ³¨æ„å¿½ç•¥äº†distogram losséƒ¨åˆ†ï¼‰
    
    ![image.png](images/image%2071.png)
    
    - åœ¨diffusionçš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå…¶é¦–å…ˆä½¿ç”¨trunkçš„è¾“å‡ºç»“æœä½œä¸ºè¾“å…¥ï¼ŒåŒ…æ‹¬åŸå§‹åŸå­ç‰¹å¾f*ï¼Œæ›´æ–°åçš„token-level pairè¡¨å¾ï¼Œtoken-level single è¡¨å¾ç­‰ã€‚
    - åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒDiffusionéƒ¨åˆ†ä¼šä½¿ç”¨ç›¸æ¯”äºtrunkéƒ¨åˆ†æ›´å¤§çš„batch_sizeï¼Œæ¯ä¸ªæ ·æœ¬é€šè¿‡trunkæ¨¡å—åï¼Œä¼šç”Ÿæˆ48ä¸ªç›¸å…³ä½†ä¸åŒçš„ä¸‰ç»´ç»“æ„ä½œä¸ºdiffusionæ¨¡å—çš„è¾“å…¥ã€‚è¿™äº›ç»“æ„éƒ½åŸºäºçœŸå®ç»“æ„ï¼ˆæ¥è‡ªäºè®­ç»ƒæ ·æœ¬çš„çœŸå®ä¸‰ç»´ç»“æ„ï¼‰ç”Ÿæˆï¼Œä½†ä¼šè¿›è¡Œéšæœºæ—‹è½¬å’Œå¹³ç§»ï¼Œå¹¶æ·»åŠ ä¸åŒç¨‹åº¦çš„å™ªå£°ã€‚è¿™æ ·çš„åšæ³•æ˜¯ä¸ºäº†è·å¾—å¤§é‡çš„ï¼ˆåŠ å™ªç»“æ„ï¼Œç›®æ ‡ç»“æ„ï¼‰å¯¹ï¼Œè®©æ‰©æ•£æ¨¡å‹å­¦ä¼šå¦‚ä½•å»å™ªã€‚
    - ç”±äºåŠ å™ªçš„å¤§å°æ˜¯éšæœºçš„ï¼Œç›¸å½“äºç”Ÿæˆäº†ä¸€ä¸ªä»tæ—¶é—´æ­¥(å±äº[0,T]ï¼ŒåŸºäºå™ªå£°å¤§å°çš„ä¸åŒï¼Œtå¯èƒ½æ˜¯æ¥è¿‘äºT-1æ—¶é—´æ­¥ï¼Œä¹Ÿå¯èƒ½æ˜¯æ¥è¿‘äº0æ—¶é—´æ­¥)çš„å¸¦å™ªå£°ç»“æ„ï¼Œç„¶åå¸Œæœ›æ¨¡å‹ç»è¿‡ä¸€æ¬¡diffusion moduleçš„æ›´æ–°åï¼Œæ¥è¿‘Tæ—¶é—´æ­¥ï¼Œä¹Ÿå°±æ˜¯å®Œå…¨æ²¡æœ‰å™ªå£°çš„çŠ¶æ€ã€‚
    - æœ€åï¼Œå¯¹äºè¿™48ä¸ªä¸åŒçš„ç»“æœï¼Œå°†å…¶å’ŒGround Truthç»“æœè¿›è¡Œå¯¹æ¯”ï¼Œè®¡ç®— lossï¼ˆL_diffusionï¼‰ï¼Œå¹¶åå‘ä¼ æ’­ï¼Œä¼˜åŒ–æ¨¡å‹ï¼ˆè¿™é‡Œæ˜¯ä»…ä»…ä¼˜åŒ–diffusion moduleè¿˜æ˜¯ä¹Ÿä¼šä¼˜åŒ–trunk moduleï¼Ÿï¼‰çš„å‚æ•°ã€‚
- Diffusionçš„losså‡½æ•°æ„é€ ï¼šæ³¨æ„è¿™é‡Œå…¶å®æ˜¯åœ¨åŸå­å±‚é¢è¿›è¡Œlosså‡½æ•°è®¡ç®—ã€‚
    - $L_{MSE}$ï¼šç”¨äºè®¡ç®—ç›®æ ‡åŸå­åæ ‡å’Œé¢„æµ‹åŸå­åæ ‡å·®å€¼çš„weighted Mean Squared Errorã€‚è¿™é‡Œå·²çŸ¥ç›®æ ‡ç”¨äºä¸‰ç»´åæ ‡çš„åŸå­åºåˆ—ï¼š{x_GT_l}ï¼Œå·²çŸ¥é¢„æµ‹ä¸‰ç»´åæ ‡åŸå­åºåˆ—{x_l}ï¼Œè®¡ç®—è¿™ä¸¤ä¸ªä¸‰ç»´ç»“æ„ä¹‹é—´çš„å·®åˆ«ï¼Œå…·ä½“çš„è®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼š
        - å…ˆå¯¹ç›®æ ‡ä¸‰ç»´ç»“æ„è¿›è¡Œä¸€æ¬¡åˆšæ€§å¯¹é½ï¼Œç›¸å½“äºæŠŠä¸¤ä¸ªç»“æ„æ•´ä½“çš„ä½ç½®å’Œæ–¹å‘å¯¹é½ï¼Œè®©ä¸¤è€…åœ¨åŒä¸€ä¸ªå‚è€ƒåæ ‡ç³»ä¸‹é¢è¿›è¡Œæ¯”è¾ƒï¼Œè¿™æ ·æ¯”è¾ƒçš„è¯¯å·®å°±æ˜¯ç»“æ„æœ¬èº«çš„å·®å¼‚ï¼Œè€Œä¸æ˜¯æ—‹è½¬æˆ–è€…ä½ç½®åç§»é€ æˆçš„ã€‚è¿™ä¹Ÿå°±è§£é‡Šäº†ï¼Œå‰é¢è®¡ç®—L_distogramçš„æ—¶å€™ï¼Œåœ¨æ²¡æœ‰è¿›è¡Œåˆšæ€§å¯¹é½çš„æƒ…å†µä¸‹ï¼Œç›´æ¥æ¯”è¾ƒçš„æ˜¯tokenä¹‹é—´çš„è·ç¦»åœ¨çœŸå®å€¼å’Œé¢„æµ‹å€¼ä¹‹é—´å·®å¼‚ï¼Œè€Œä¸æ˜¯ç›´æ¥æ¯”è¾ƒtokençš„åæ ‡çš„å·®å¼‚ã€‚
            
            ![image.png](images/image%2072.png)
            
        - ç„¶åè®¡ç®—L_mseçš„å€¼ï¼š $L_{MSE} = \frac{1}{3} \cdot \text{mean}_l \big( w_l \| \tilde{x}_l - x_l^{GT-aligned} \|^2 \big)$
        - æ³¨æ„è¿™é‡Œæ˜¯ä¸€ä¸ªweighted Mean Squared Errorï¼š $w_l = 1 + f_l^{\text{is-dna}} \alpha^{\text{dna}} + f_l^{\text{is-rna}} \alpha^{\text{rna}} + f_l^{\text{is-ligand}} \alpha^{\text{ligand}}$ ï¼Œå…¶ä¸­ $\alpha^{\text{dna}} = \alpha^{\text{rna}} = 5,  \alpha^{\text{ligand}} = 10$ ã€‚è¿™é‡Œå¯¹RNA/DNAå’Œligandçš„æƒé‡è®¾ç½®çš„è¾ƒå¤§ï¼Œæ„å‘³ç€å¦‚æœè¿™äº›åŸå­çš„é¢„æµ‹å‡†ç¡®æ€§æœ‰æ›´é«˜çš„è¦æ±‚ã€‚
    - $L_{bond}$ ï¼šç”¨äºç¡®ä¿é…ä½“ï¼ˆligand)å’Œä¸»é“¾ä¹‹é—´çš„é”®é•¿æ˜¯åˆç†çš„æŸå¤±å‡½æ•°ã€‚
        - ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªlosså‘¢ï¼ŸåŸå› åœ¨äºæ‰©æ•£æ¨¡å‹å¯ä»¥æ¢å¤å‡ºä¸€ä¸ªæ€»ä½“ç»“æ„æ­£ç¡®ï¼Œä½†æ˜¯ç»†èŠ‚ä¸å¤Ÿç²¾ç¡®çš„æ¨¡å‹ï¼Œæ¯”å¦‚æŸä¸€ä¸ªåŒ–å­¦é”®å˜å¾—è¿‡é•¿æˆ–è€…è¿‡çŸ­ã€‚åŒæ—¶é…ä½“å°±åƒæŒ‚åœ¨è›‹ç™½è´¨é“¾è¾¹ä¸Šçš„å°é¥°å“ï¼Œä½ ä¸å¸Œæœ›è¿™ä¸ªé¥°å“è¿‡é•¿æˆ–è€…è¿‡çŸ­ï¼Œè€Œè›‹ç™½è´¨æ°¨åŸºé…¸ä¹‹é—´çš„è‚½é”®åŸºæœ¬é•¿åº¦æ˜¯ç¨³å®šçš„ï¼Œä¸»é“¾å†…éƒ¨åŸå­æ’åˆ—çš„æœ¬èº«å°±æœ‰æ¯”è¾ƒå¼ºçš„çº¦æŸã€‚
        - æ‰€ä»¥è¿™é‡Œçš„è®¡ç®—æ–¹æ³•ä¸ºï¼š $\mathcal{L}\_{\text{bond}} = \text{mean}\_{(l,m) \in \mathcal{B}} \left( \left\| \vec{x}\_l - \vec{x}\_m \right\| - \left\| \vec{x}\_l^{\text{GT}} - \vec{x}\_m^{\text{GT}} \right\| \right)^2$ ï¼Œè¿™é‡Œçš„ $\mathcal{B}$æŒ‡çš„æ˜¯ä¸€ç³»åˆ—çš„åŸå­å¯¹ï¼ˆlæ˜¯èµ·å§‹åŸå­çš„åºå·ï¼Œmæ˜¯ç»“æŸåŸå­çš„åºå·ï¼‰ï¼Œä»£è¡¨çš„æ˜¯protein-ligand bondsã€‚ç›¸å½“äºè®¡ç®—ç›®æ ‡é”®é•¿å’ŒçœŸå®é”®é•¿ä¹‹é—´çš„å¹³å‡å·®è·ã€‚
        - æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªMSEçš„lossã€‚
    - $L_{smooth-LDDT}$ï¼šç”¨äºæ¯”è¾ƒé¢„æµ‹çš„åŸå­å¯¹ä¹‹é—´çš„è·ç¦»å’Œå®é™…åŸå­å¯¹ä¹‹é—´è·ç¦»çš„å·®å¼‚çš„loss ï¼ˆLocal Distance Difference Testï¼‰ï¼Œå¹¶ä¸”ç€é‡å…³æ³¨ç›¸è¿‘åŸå­ä¹‹é—´çš„è·ç¦»é¢„æµ‹çš„å‡†ç¡®æ€§ï¼ˆLocal Distance Difference Testï¼‰ã€‚
        - å…·ä½“çš„è®¡ç®—ä¼ªä»£ç ä¸ºï¼š
            
            ![image.png](images/image%2073.png)
            
            - å‰ä¸¤æ­¥è®¡ç®—ä»»æ„ä¸¤ä¸ªåŸå­ä¹‹é—´çš„è·ç¦»ï¼ŒåŒ…æ‹¬é¢„æµ‹å€¼å’Œå®é™…å€¼ã€‚
            - æ¥ä¸‹æ¥è®¡ç®—(l,m)åŸå­å¯¹çš„é¢„æµ‹è·ç¦»å’Œå®é™…è·ç¦»çš„ç»å¯¹å·®å€¼ $\delta\_{lm}$ã€‚
            - ç„¶åè®¡ç®—ä¸€ä¸ªåˆ†å¸ƒåœ¨[0,1]ä¹‹é—´çš„è¯„åˆ†ï¼Œè¿™ä¸ªè¯„åˆ†ç”¨äºè¡¡é‡ $\delta\_{lm}$ æ˜¯å¦èƒ½å¤Ÿé€šè¿‡ï¼ˆLocal Distance Difference Testï¼‰ã€‚
                - è¿™é‡Œè®¾ç½®äº†4æ¬¡Testï¼Œæ¯æ¬¡Testé‡‡ç”¨äº†ä¸åŒçš„é˜ˆå€¼ï¼Œå¦‚æœ $\delta\_{lm}$ åœ¨è®¾å®šçš„é˜ˆå€¼èŒƒå›´å†…ï¼Œåˆ™å¯ä»¥è®¤ä¸ºå¯¹(l,m)è¿™ä¸ªåŸå­å¯¹è·ç¦»çš„é¢„æµ‹é€šè¿‡äº†Testï¼Œé‚£ä¹ˆè¿™æ¬¡çš„Testçš„è¯„åˆ†å°±ä¼šå¤§äº0.5ï¼Œå¦åˆ™ä¸é€šè¿‡å°äº0.5.
                - æ‰€ä»¥æ¯æ¬¡Testè®¾ç½®äº†ä¸åŒçš„é˜ˆå€¼ï¼ˆåˆ†åˆ«ä¸º4, 2, 1, and 0.5 Ã…ï¼‰ï¼Œé‡‡ç”¨sigmoidå‡½æ•°æ¥å®ç°ï¼šsigmoid(é˜ˆå€¼ -  $\delta\_{lm}$ )ï¼Œä¸‹é¢ç”»å‡ºäº†è¿™å››ä¸ªTestçš„å‡½æ•°æ›²çº¿ï¼š
                    
                    ![Individual Sigmoid Terms in Smooth LDDT.png](images/Individual_Sigmoid_Terms_in_Smooth_LDDT.png)
                    
                - ç„¶åå¯¹è¿™å››ä¸ªTestçš„ç»“æœè¿›è¡Œå¹³å‡ï¼Œå¾—åˆ°è¯„åˆ† $\epsilon\_{lm}$ï¼Œè¿™æ˜¯è¿™ä¸ªè¯„åˆ†çš„æ›²çº¿ï¼Œä½ ä¼šå‘ç°è¶Šé è¿‘0ï¼Œè¿™ä¸ªè¯„åˆ†è¶Šæ¥è¿‘äº1ï¼Œå¦åˆ™è¶Šæ¥è¿‘äº0.
                    
                    ![Smooth LDDT Component vs Distance Difference.png](images/Smooth_LDDT_Component_vs_Distance_Difference.png)
                    
            - ç„¶åï¼Œä¸ºäº†è®©è¿™ä¸ªè®¡ç®—åˆ†æ•°ä¸»è¦è€ƒå¯Ÿçš„æ˜¯ç›¸è¿‘åŸå­ä¹‹é—´çš„è·ç¦»ï¼Œæ‰€ä»¥å¯¹é‚£äº›å®é™…è·ç¦»éå¸¸è¿œçš„åŸå­å¯¹ï¼Œä¸åŠ å…¥åˆ°lossçš„è®¡ç®—ï¼ˆc_l_m=0ï¼‰ã€‚å³é’ˆå¯¹å®é™…è·ç¦»å¤§äº30Ã…çš„æ ¸è‹·é…¸åŸå­å¯¹ä»¥åŠå®é™…è·ç¦»å¤§äº15Ã…çš„éæ ¸è‹·é…¸åŸå­å¯¹ä¸è®¡å…¥åœ¨å†…ã€‚
            - æœ€åï¼Œè®¡ç®—é‚£äº›c_l_mä¸ä¸º0çš„åŸå­å¯¹çš„ $\epsilon\_{lm}$ è¯„åˆ†çš„å‡å€¼åšä¸ºlddtçš„å€¼ï¼Œè¿™ä¸ªå€¼è¶Šæ¥è¿‘äº1ï¼Œåˆ™å¹³å‡åŸå­å¯¹é¢„æµ‹çš„è¶Šå‡†ã€‚å°†å…¶æ¢ç®—æˆlossï¼Œä¸º1-lddtã€‚
    - æœ€åçš„æœ€åï¼Œ $\mathcal{L}\_{\text{diffusion}} = \frac{\hat{t}^2 + \sigma\_{\text{data}}^2}{(\hat{t} + \sigma\_{\text{data}})^2} \cdot \left( \mathcal{L}\_{\text{MSE}} + \alpha\_{\text{bond}} \cdot \mathcal{L}\_{\text{bond}} \right) + \mathcal{L}\_{\text{smooth-lddt}}$
        - è¿™é‡Œçš„ $\sigma_{data}$ æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œç”±æ•°æ®çš„æ–¹å·®å†³å®šï¼Œè¿™é‡Œå–16ã€‚
        - è¿™é‡Œçš„t^æ˜¯åœ¨è®­ç»ƒæ—¶çš„sampled noise levelï¼Œå…·ä½“çš„è®¡ç®—æ–¹æ³•æ˜¯ $\hat{t}=\sigma_{\text{data}} \cdot \exp\left( -1.2 + 1.5 \cdot \mathcal{N}(0, 1) \right)$
        - è¿™é‡Œçš„ $\alpha_{bond}$ åœ¨åˆå§‹è®­ç»ƒçš„æ—¶å€™æ˜¯0ï¼Œåœ¨åé¢fine-tuneçš„æ—¶å€™æ˜¯1.

## $L_{confidence}$

- æœ€åä¸€ç§lossçš„ä½œç”¨å¹¶ä¸æ˜¯ç”¨æ¥æå‡æ¨¡å‹é¢„æµ‹ç»“æ„çš„å‡†ç¡®æ€§ï¼Œè€Œæ˜¯å¸®åŠ©æ¨¡å‹å­¦ä¹ å¦‚ä½•è¯„ä¼°è‡ªèº«é¢„æµ‹çš„å‡†ç¡®æ€§ã€‚è¿™ä¸ªlossä¹Ÿæ˜¯å››ç§ä¸åŒç”¨äºè¯„ä¼°è‡ªèº«å‡†ç¡®æ€§lossçš„ä¸€ä¸ªåŠ æƒå’Œã€‚
- å…·ä½“çš„å…¬å¼å¦‚ä¸‹ï¼š $L\_{confidence}= \mathcal{L}\_{\text{plddt}} + \mathcal{L}\_{\text{pde}} + \mathcal{L}\_{\text{resolved}} + \alpha\_{\text{pae}} \cdot \mathcal{L}\_{\text{pae}}$
- Mini-Rolloutè§£é‡Šï¼š
    
    ![image.png](images/image%2074.png)
    
    - **åŸç†**ï¼šæ­£å¸¸æƒ…å†µä¸‹ï¼Œè¦è®¡ç®—æ¨¡å‹å¯¹ç”Ÿæˆçš„ä¸‰ç»´ç»“æ„çš„ç½®ä¿¡åº¦ï¼Œéœ€è¦è·å–æ¨¡å‹æœ€ç»ˆç”Ÿæˆçš„ä¸‰ç»´ç»“æ„è¿›è¡Œè®¡ç®—ï¼Œè¿™ä¸AF2çš„åšæ³•ç±»ä¼¼ã€‚ä½†å¯¹äºAF3æ¥è¯´ï¼Œdiffusion moduleå•æ¬¡è¿­ä»£æ— æ³•ç›´æ¥ç”Ÿæˆæœ€ç»ˆçš„å»å™ªç»“æœã€‚å› æ­¤ï¼Œè¿™é‡Œå¼•å…¥äº†mini-rolloutæœºåˆ¶ï¼šåœ¨è®­ç»ƒæ—¶å¯¹Diffusion moduleè¿›è¡Œå›ºå®šæ¬¡æ•°ï¼ˆ20æ¬¡ï¼‰çš„è¿­ä»£ï¼Œä»è€Œè®©æ¨¡å‹èƒ½ä»éšæœºå™ªå£°å¿«é€Ÿç”Ÿæˆä¸€ä¸ªè¿‘ä¼¼çš„è›‹ç™½è´¨ç»“æ„é¢„æµ‹ã€‚ç„¶ååˆ©ç”¨è¿™ä¸ªä¸´æ—¶é¢„æµ‹æ¥è®¡ç®—è¯„ä¼°æŒ‡æ ‡å’Œè®­ç»ƒconfidence headã€‚
    - **æ¢¯åº¦é˜»æ–­**ï¼šæ³¨æ„è¿™é‡Œçš„mini-rolloutå¹¶ä¸å›ä¼ æ¢¯åº¦ï¼ˆå¦‚å›¾ä¸­çº¢è‰²STOPæ ‡è¯†ã€‚ä¸ç”¨äºä¼˜åŒ–Diffusionæ¨¡å—ä¹Ÿä¸ç”¨äºä¼˜åŒ–Network trunkæ¨¡å—ï¼‰ï¼Œå› ä¸ºè®¡ç®—L_confidenceçš„ä¸»è¦ç›®æ ‡æ˜¯ä¼˜åŒ–æ¨¡å‹å¯¹ç”Ÿæˆç»“æ„è´¨é‡çš„è¯„ä¼°èƒ½åŠ›ï¼Œå³ä¼˜åŒ–confidence moduleæœ¬èº«çš„æ€§èƒ½ã€‚è¿™ç§è®¾è®¡ç¡®ä¿äº†diffusionæ¨¡å—çš„è®­ç»ƒç›®æ ‡ï¼ˆå•æ­¥å»å™ªï¼‰å’Œconfidence headçš„è®­ç»ƒç›®æ ‡ï¼ˆç»“æ„è´¨é‡åº¦é‡ï¼‰ç›¸äº’ç‹¬ç«‹ï¼Œé¿å…äº†è®­ç»ƒç›®æ ‡ä¸ä¸€è‡´å¯¼è‡´çš„å†²çªã€‚åŒæ—¶ä¹Ÿä¿è¯äº†Trunkæ¨¡å—çš„è®­ç»ƒç›®æ ‡ï¼ˆæä¾›æ›´å¥½çš„ç‰¹å¾è¡¨å¾ï¼Œä¸ºåç»­ç»“æ„ç”Ÿæˆæä¾›ä¸°å¯Œä¸”é€šç”¨çš„ç‰¹å¾è¡¨ç¤ºï¼‰å’Œconfidence headçš„è®­ç»ƒç›®æ ‡ï¼ˆç»“æ„è´¨é‡åº¦é‡ï¼‰èƒ½å¤Ÿç›¸äº’ç‹¬ç«‹ã€‚
- æ³¨æ„ï¼Œè¿™äº›confidence losséƒ½åªé’ˆå¯¹PDBæ•°æ®é›†ä½¿ç”¨ï¼ˆä¸é€‚ç”¨äºä»»ä½•è’¸é¦æ•°æ®é›†ï¼Œè’¸é¦æ•°æ®é›†çš„ç»“æ„æ˜¯é¢„æµ‹ç»“æ„ä¸æ˜¯çœŸå®ç»“æ„ï¼‰ï¼›åŒæ—¶åœ¨æ•°æ®é›†ä¸Šè¿›è¡Œè¿‡æ»¤ï¼Œåªé€‰æ‹©è¿‡æ»¤åˆ†è¾¨ç‡ï¼ˆ0.1åŸƒåˆ°4åŸƒä¹‹é—´ï¼‰çš„çœŸå®ç»“æ„è¿›è¡Œconfidence lossçš„è®­ç»ƒï¼Œä¸ºäº†ç¡®ä¿æ¨¡å‹èƒ½å¤Ÿå­¦ä¹ åˆ°ä¸çœŸå®ç‰©ç†ç»“æ„æ¥è¿‘çš„è¯¯å·®åˆ†å¸ƒã€‚
- ä¸‹é¢åˆ†åˆ«è¯¦ç»†è§£é‡Šæ¯ä¸€ä¸ªlossçš„å«ä¹‰ï¼š
    - Predicted Local Distance Difference Test(pLDDT)ï¼šæ¯ä¸ªåŸå­çš„å¹³å‡ç½®ä¿¡åº¦ã€‚ï¼ˆæ³¨æ„Alphafold2æ˜¯æ¯ä¸ªæ®‹åŸºçš„å¹³å‡ç½®ä¿¡åº¦ï¼‰
        - è®¡ç®—å•ä¸ªåŸå­çš„LDDTï¼š $lddt_l$ï¼ˆè®­ç»ƒæ—¶ï¼‰ï¼š
            - è¿™é‡Œçš„ç›®æ ‡æ˜¯ä¼°è®¡é¢„æµ‹ç»“æ„å’ŒçœŸå®ç»“æ„ä¹‹é—´çš„å·®å¼‚ï¼Œä¸”è¿™é‡Œæ˜¯é’ˆå¯¹ç‰¹å®šåŸå­çš„ä¸€ä¸ªå·®å¼‚çš„ä¼°è®¡ã€‚
            - æ‰€ä»¥è¿™é‡Œçš„è®¡ç®—å…¬å¼å¦‚ä¸‹è®¾ç½®ï¼š
                
                ![image.png](images/image%2075.png)
                
                - å…¶ä¸­ $d_{lm}$ æ˜¯mini-rolloutçš„é¢„æµ‹çš„åŸå­lå’Œmä¹‹é—´çš„è·ç¦»ã€‚
                - ${m}\in{R}$ ï¼ŒmåŸå­çš„é€‰æ‹©æ˜¯åŸºäºæ­¤è®­ç»ƒåºåˆ—çš„çœŸå®ä¸‰ç»´ç»“æ„æ¥è·å–ï¼š1ï¼‰mçš„è·ç¦»åœ¨lçš„ä¸€å®šå°±è¿‘èŒƒå›´å†…ï¼ˆ30åŸƒæˆ–è€…15åŸƒï¼Œå–å†³äºmçš„åŸå­ç±»å‹ï¼‰ï¼›2ï¼‰måªé€‰æ‹©ä½äºèšåˆç‰©ä¸Šçš„åŸå­ï¼ˆå°åˆ†å­å’Œé…ä½“ä¸è€ƒè™‘ï¼‰ï¼›3ï¼‰ä¸€ä¸ªtokenåªè€ƒè™‘ä¸€ä¸ªåŸå­ï¼Œé’ˆå¯¹æ ‡å‡†æ°¨åŸºé…¸æˆ–è€…æ ¸è‹·é…¸ä¸­çš„åŸå­ï¼Œméƒ½æ˜¯ç”¨å…¶ä»£è¡¨åŸå­ï¼ˆ $C_\alpha$ æˆ– $C_1$ï¼‰æ¥è¡¨ç¤ºã€‚
                - ç„¶åé’ˆå¯¹æ¯ä¸€å¯¹(l,m)ï¼Œè¿›è¡ŒLDDTï¼ˆLocal Distance Difference Testï¼‰ï¼š $\frac{1}{4} \sum_{c \in \{0.5, 1, 2, 4\}} d\_{lm} < c$ï¼Œå¦‚æœlå’Œmåœ¨çœŸå®è·ç¦»ä¸­æ¯”è¾ƒè¿‘ï¼Œé‚£ä¹ˆä»–ä»¬åœ¨é¢„æµ‹ç»“æœä¸­åº”è¯¥ä¹Ÿè¶³å¤Ÿè¿‘ï¼Œè¿™é‡Œè®¾ç½®äº†4ä¸ªé˜ˆå€¼ï¼Œå¦‚æœéƒ½æ»¡è¶³ï¼Œåˆ™LDDTåˆ™ä¸º1ï¼Œå¦‚æœéƒ½ä¸æ»¡è¶³åˆ™ä¸º0ã€‚
                - æœ€åï¼Œç›¸å½“äºé’ˆå¯¹æ‰€æœ‰åœ¨lé™„è¿‘çš„mè®¡ç®—å¾—åˆ°çš„LDDTå€¼è¿›è¡ŒåŠ åˆï¼Œå¾—åˆ°ä¸€ä¸ªlåŸå­çš„ $lddt_l$ å€¼ï¼Œå…¶å¤§å°å¯ä»¥è¡¡é‡åœ¨låŸå­ä¸Šæ¨¡å‹çš„é¢„æµ‹ç»“æ„å’ŒçœŸå®ç»“æ„çš„å·®å¼‚ï¼Œæ³¨æ„è¿™æ˜¯ä¸€ä¸ªæ²¡æœ‰ç»è¿‡å½’ä¸€åŒ–çš„å€¼ã€‚
        - è®¡ç®—confidence headè¾“å‡ºçš„æ­¤åŸå­çš„LDDTçš„æ¦‚ç‡åˆ†å¸ƒï¼š $p_l^{\text{plddt}}$ï¼ˆè®­ç»ƒå’Œé¢„æµ‹æ—¶ï¼‰
            - è¿™é‡Œæš‚æ—¶å¿½ç•¥å…·ä½“confidenceçš„è®¡ç®—è¿‡ç¨‹ï¼ˆåç»­ä¼šè¯¦ç»†è¯´æ˜ï¼‰ï¼Œéœ€è¦çŸ¥é“çš„æ˜¯è¿™é‡Œçš„ $p_l^{\text{plddt}}$ æ˜¯åœ¨låŸå­å¤„ç»è¿‡confidence headè®¡ç®—å¾—åˆ°çš„ï¼Œå¯¹ $lddt_l$ å€¼çš„åˆ†å¸ƒçš„ä¸€ä¸ªä¼°è®¡ã€‚
            - è¿™é‡Œ $p_l^{\text{plddt}}$ æ˜¯ä¸€ä¸ª50ç»´çš„å‘é‡ï¼Œå°†0ï½100åˆ†æˆäº†50binï¼Œæ˜¯ä¸€ä¸ªsoftmaxçš„ç»“æœï¼Œé¢„æµ‹äº† $lddt_l$ å€¼è½åœ¨å…¶ä¸­ç‰¹å®šbinçš„æ¦‚ç‡åˆ†å¸ƒã€‚
            - æ³¨æ„è¿™é‡Œçš„è®¡ç®—å®Œå…¨ä¸æ¶‰åŠä»»ä½•çš„çœŸå®ç»“æ„ï¼Œéƒ½æ˜¯åŸºäºå‰é¢çš„trunkç›¸å…³è¡¨å¾è¿›è¡Œçš„é¢„æµ‹ã€‚
        - è®¡ç®—æ•´ä¸ªçš„ $L_{plddt}$ï¼ˆè®­ç»ƒæ—¶ï¼‰ï¼š
            - é‚£ä¹ˆè¿™é‡Œè¿™ä¸ªlossçš„ä¼˜åŒ–ç›®æ ‡å°±ä¸æ˜¯æœ€å¤§åŒ– $lddt_l$ï¼Œè€Œæ˜¯ä¸ºäº†æ›´åŠ å‡†ç¡®åœ°é¢„æµ‹ $lddt_l$ ã€‚
            - è€Œåº”è¯¥æ˜¯å®é™…çš„ $lddt_l$ å€¼å’Œæ¨¡å‹é¢„æµ‹çš„ $lddt_l$ åˆ†å¸ƒè¦å§‹ç»ˆå¯¹é½ï¼šå¦‚æœå®é™…çš„ $lddt_l$ å€¼ä½ï¼ˆæ¨¡å‹ç»“æ„é¢„æµ‹çš„ä¸å‡†ï¼‰é‚£ä¹ˆæ¨¡å‹çš„é¢„æµ‹çš„ $lddt_l$ çš„åˆ†å¸ƒ $p_l^{\text{plddt}}$ ç»“æœä¸­ï¼Œè½åœ¨æ•°å€¼è¾ƒå°çš„binä¸­çš„æ¦‚ç‡å°±æ›´å¤§ï¼›å¦‚æœå®é™…çš„     $lddt_l$ å€¼é«˜ï¼ˆæ¨¡å‹ç»“æ„é¢„æµ‹çš„å‡†ï¼‰é‚£ä¹ˆæ¨¡å‹çš„é¢„æµ‹çš„ $lddt_l$ çš„åˆ†å¸ƒ $p_l^{\text{plddt}}$ ç»“æœä¸­ï¼Œè½åœ¨æ•°å€¼è¾ƒå¤§çš„binä¸­çš„æ¦‚ç‡å°±æ›´å¤§ã€‚
            - æ‰€ä»¥ä½¿ç”¨äº¤å‰ç†µlossæ¥å¯¹é½è¿™ä¸¤è€…çš„å·®å¼‚ï¼Œè¿™ä¹Ÿå°±èƒ½å¤Ÿä¿è¯æ¨¡å‹çœŸå®çš„LDDTåˆ†å¸ƒå’Œé¢„æµ‹çš„LDDTåˆ†å¸ƒæ˜¯å°½é‡ä¸€è‡´çš„ï¼š $\sum_{b=1}^{50} \text{lddt}_l^b \log p_l^b$ ã€‚
            - æœ€åï¼Œå› ä¸ºè¦è®¡ç®—æ•´ä½“çš„lossï¼Œæ‰€ä»¥åœ¨æ‰€æœ‰åŸå­ä¸Šè¿›è¡Œå¹³å‡ï¼Œå¾—åˆ°æœ€ç»ˆè®¡ç®—çš„æ–¹æ³•ï¼š
                
                ![image.png](images/image%2076.png)
                
        - è®¡ç®—pLDDTçš„å€¼ï¼ˆé¢„æµ‹æ—¶ï¼‰ï¼š
            - å¦å¤–ï¼Œåœ¨é¢„æµ‹çš„æ—¶å€™ï¼Œæ¨¡å‹è¾“å‡ºçš„å•ä¸ªåŸå­çš„pLDDTçš„å€¼æ—¶ï¼Œè®¡ç®—æ–¹å¼ä¸ºï¼š $p_l^{\text{plddt}} * V_{bin}$ ï¼Œå¾—åˆ°ä¸€ä¸ª0ï½100ä¹‹é—´çš„æ ‡é‡ï¼Œä»£è¡¨äº†æ¨¡å‹å¯¹å½“å‰ä½ç½®låŸå­çš„lddtçš„ä¸€ä¸ªé¢„æµ‹å€¼ã€‚å½“è¿™ä¸ªåŸå­å‘¨è¾¹çš„åŸå­å’Œå®ƒè·ç¦»éƒ½æ¯”è¾ƒè¿‘çš„æ—¶å€™lddtå€¼å¤§ï¼Œä»£è¡¨æ¨¡å‹å¯¹å½“å‰låŸå­ä½ç½®é¢„æµ‹çš„ç½®ä¿¡åº¦å°±è¶Šé«˜ï¼Œå¦åˆ™å¯¹å½“å‰låŸå­ä½ç½®é¢„æµ‹çš„ç½®ä¿¡åº¦å°±è¶Šä½ã€‚
            - åŸå› åœ¨äºï¼Œç»è¿‡å‰é¢çš„losså‡½æ•°çš„ä¼˜åŒ–ï¼Œ $p_l^{\text{plddt}}$ æ˜¯ä¸€ä¸ªå¯¹låŸå­çš„é¢„æµ‹æ•ˆæœæœ‰è¾ƒå¥½è¯„ä¼°èƒ½åŠ›çš„åˆ†å¸ƒäº†ã€‚æ‰€ä»¥å°±å¯ä»¥ç›¸ä¿¡ $p_l^{\text{plddt}}$ å¯¹lddtåˆ†å¸ƒçš„ä¼°è®¡ï¼Œå¯ä»¥ç›¸å½“äºæ±‚æœŸæœ›çš„æ–¹å¼æ¥æ±‚lddtçš„é¢„æµ‹å€¼ã€‚
    - Predicted Aligned Error(PAE)ï¼štokenå¯¹ä¹‹é—´çš„å¯¹é½è¯¯å·®çš„ç½®ä¿¡åº¦é¢„æµ‹ï¼ˆä»¥åŸå­å¯¹çš„è·ç¦»æ¥è®¡ç®—ï¼‰ã€‚
        - ä¸€äº›æ¦‚å¿µå’Œæ–¹æ³•è§£é‡Šï¼š
            - **reference frame:** ä¸€ä¸ªtokençš„reference frameä½¿ç”¨ä¸‰ä¸ªåŸå­çš„åæ ‡æ¥è¿›è¡Œè¡¨ç¤º: $\Phi_i = (\vec{a}_i, \vec{b}_i, \vec{c}_i)$ï¼Œ è¿™ä¸ªframeçš„ä½œç”¨æ˜¯ç”¨äºå®šä¹‰ä¸€ä¸ªtoken i çš„å±€éƒ¨å‚è€ƒåæ ‡ç³»ï¼Œç”¨äºä¸token j å»ºç«‹è”ç³»ã€‚é’ˆå¯¹ä¸åŒçš„tokenï¼Œreferecne frameçš„ä¸‰ä¸ªåŸå­çš„é€‰æ‹©æ˜¯ä¸åŒçš„ï¼š
                - é’ˆå¯¹è›‹ç™½è´¨tokenï¼Œæˆ–è€…æ®‹åŸºï¼Œå…¶reference frameæ˜¯ï¼š $(\text{N}, \text{C}^\alpha, \text{C})$
                - é’ˆå¯¹DNAæˆ–è€…RNAçš„tokenï¼Œå…¶reference frameæ˜¯ï¼š $(\text{C1}', \text{C3}', \text{C4}')$
                - é’ˆå¯¹å…¶ä»–å°åˆ†å­ï¼Œå…¶tokenå¯èƒ½åªåŒ…å«ä¸€ä¸ªåŸå­ï¼Œé‚£ä¹ˆé€‰æ‹©b_iä¸ºè¿™ä¸ªåŸå­æœ¬èº«ï¼Œç„¶åé€‰æ‹©æœ€è¿‘çš„atomä¸ºa_iï¼Œç¬¬äºŒè¿‘çš„atomä¸ºc_iã€‚
                - ä¾‹å¤–ï¼šå¦‚æœé€‰æ‹©çš„ä¸‰ä¸ªåŸå­å‡ ä¹åœ¨ä¸€æ¡ç›´çº¿ä¸Šï¼ˆå®ƒä»¬ä¹‹é—´çš„å¤¹è„šå°äº25åº¦ï¼‰ï¼Œæˆ–è€…åœ¨å®é™…çš„é“¾é‡Œæ‰¾ä¸åˆ°è¿™ä¸‰ä¸ªåŸå­ï¼ˆæ¯”å¦‚é’ ç¦»å­åªæœ‰ä¸€ä¸ªåŸå­ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªframeè¢«å®šä¹‰ä¸ºæ— æ•ˆframeï¼Œåç»­ä¸å‚ä¸è®¡ç®—PAEã€‚
            - $\text{expressCoordinatesInFrame}(\vec{x}, \Phi)$ : åœ¨ $\Phi$ åæ ‡ç³»ä¸‹æ¥è¡¨ç¤ºåŸå­ $\vec{x}$ çš„åæ ‡ã€‚
                
                ![image.png](images/image%2077.png)
                
                - ç²—ç•¥çš„è§£é‡Šè¿™ä¸ªç®—æ³•ï¼š
                    - é¦–å…ˆï¼Œä» $\Phi$ ä¸­å¾—åˆ°ä¸‰ä¸ªå‚è€ƒåŸå­çš„åæ ‡a,b,cã€‚å°†bè§†ä½œæ–°åæ ‡ç³»çš„åŸç‚¹ã€‚
                    - ç„¶åï¼Œä»båˆ°aå’Œä»båˆ°cçš„æ–¹å‘ï¼Œæ„é€ ä¸€ä¸ªæ­£äº¤è§„èŒƒåŸº(e_1, e_2, e_3)ã€‚
                    - æœ€åï¼Œå°†xæŠ•å½±åˆ°è¿™ä¸ªæ–°çš„åŸºä¸Šï¼Œå¾—åˆ°x_transformedè¿™ä¸ªåœ¨æ–°çš„åæ ‡ç³» $\Phi$ ä¸Šçš„åæ ‡ã€‚
                - å…·ä½“çš„è¯¦ç»†è§£é‡Šè¿™ä¸ªç®—æ³•ï¼š
                    - å·²çŸ¥ä¸‰ä¸ªå‚è€ƒåŸå­çš„åæ ‡ï¼Œç„¶åéœ€è¦ä»¥båŸå­çš„åæ ‡ä¸ºåŸç‚¹æ¥æ„å»ºä¸€ä¸ªæ­£äº¤çš„ä¸‰ç»´åæ ‡ç³»ã€‚
                    - è®¡ç®—w1å’Œw2ï¼Œå®ƒä»¬æ˜¯ä»båˆ°aæ–¹å‘ä¸Šçš„ä¸€ä¸ª**å•ä½å‘é‡**å’Œä»båˆ°cæ–¹å‘ä¸Šçš„ä¸€ä¸ª**å•ä½å‘é‡**ã€‚
                    - ç„¶åè®¡ç®—æ­£äº¤åŸºï¼š
                        - e1å¯ä»¥çœ‹æˆæ˜¯ä½äºaå’Œcä¹‹é—´â€œå¤¹è§’å¹³åˆ†â€çš„ä¸€ä¸ªæ–¹å‘ã€‚
                        - e2æ˜¯å°†w1å’Œw2ç›¸å‡ä¹‹åçš„ä¸€ä¸ªæ–¹å‘ï¼Œå› ä¸ºw1å’Œw2éƒ½æ˜¯å•ä½å‘é‡ï¼Œæ‰€ä»¥è¿™ä¸ªå‘é‡å’Œe1æ˜¯æ­£äº¤çš„ï¼Œè€Œä¸”ä¹Ÿåœ¨åŒä¸€ä¸ªå¹³é¢ä¸Šã€‚
                        - e3æ˜¯å°†e2å’Œe1åšå‰ä¹˜ï¼Œå¾—åˆ°ä¸ä¸¤è€…éƒ½å‚ç›´çš„ç¬¬ä¸‰ä¸ªåŸºå‘é‡ï¼Œä»è€Œå½¢æˆä¸‰ä¸ªå®Œæ•´çš„æ­£äº¤åŸºã€‚
                        - å®Œæˆè¿™ä¸€æ­¥åï¼Œe1ï¼Œe2ï¼Œe3å°±æ˜¯ä¸€ä¸ªåœ¨ä»¥bä¸ºåŸç‚¹ä¸‹çš„å³æ‰‹ç³»è§„èŒƒæ­£äº¤åŸºã€‚
                    - æœ€åå°†xæŠ•å½±åˆ°è¿™ä¸ªåæ ‡ç³»ä¸Šé¢ï¼š
                        - é¦–å…ˆï¼Œå°†xå¹³ç§»ï¼Œä½¿å¾—bæˆä¸ºåŸç‚¹ã€‚
                        - ç„¶åï¼Œè¿›è¡ŒæŠ•å½±ï¼Œè®¡ç®—dåœ¨æ¯ä¸ªåŸºå‘é‡ä¸Šçš„æŠ•å½±ï¼Œå³ï¼ˆd*e1, d*e2, d*e3ï¼‰ã€‚
                        - æœ€åï¼Œå°±å¾—åˆ°äº†xåœ¨åæ ‡ç³» $\Phi$ ä¸­çš„æ–°åæ ‡ï¼šx_transformedã€‚
            - $\text{computeAlignmentError}(\{\vec{x}_i\}, \{\vec{x}_i^\text{true}\}, \{\Phi_i\}, \{\Phi_i^\text{true}\}, \epsilon = 1e^{-8} \, \text{Ã…}^2)$ï¼šè®¡ç®—token i å’Œ token j ä¹‹é—´çš„å¯¹é½è¯¯å·®ã€‚
                
                ![image.png](images/image%2078.png)
                
                - è¾“å…¥ï¼š
                    - x_i æŒ‡çš„æ˜¯é¢„æµ‹çš„é’ˆå¯¹token i çš„ä»£è¡¨æ€§åŸå­çš„åæ ‡ï¼Œx_true_i æŒ‡çš„æ˜¯çœŸå®çš„token i çš„ä»£è¡¨æ€§åŸå­çš„åæ ‡ã€‚
                    - $\Phi_i$æŒ‡çš„æ˜¯é¢„æµ‹çš„é’ˆå¯¹token i çš„reference frameï¼Œ $\Phi_i^\text{true}$ æŒ‡çš„æ˜¯çœŸå®çš„token i çš„reference frameã€‚
                - è®¡ç®—æµç¨‹ï¼š
                    - tokenå¯¹(i, j)ä¹‹é—´å…³ç³»çš„é¢„æµ‹ç»“æœï¼šåœ¨ token i çš„ reference frame å±€éƒ¨åæ ‡ç³»ä¸‹ï¼Œè®¡ç®—token j çš„ä»£è¡¨æ€§åŸå­åœ¨è¿™ä¸ªåæ ‡ç³»ä¸­çš„åæ ‡ï¼Œç›¸å½“äºè®¡ç®—token j ç›¸å¯¹äº token içš„ç›¸å¯¹å…³ç³»ã€‚
                    - tokenå¯¹(i, j)ä¹‹é—´å…³ç³»çš„çœŸå®ç»“æœï¼šåœ¨ token i çš„ reference frame å±€éƒ¨åæ ‡ç³»ä¸‹ï¼Œè®¡ç®—token j çš„ä»£è¡¨æ€§åŸå­åœ¨è¿™ä¸ªåæ ‡ç³»ä¸­çš„åæ ‡ï¼Œç›¸å½“äºè®¡ç®—token j ç›¸å¯¹äº token içš„ç›¸å¯¹å…³ç³»ã€‚
                    - è®¡ç®—å¯¹é½è¯¯å·®ï¼Œå³é¢„æµ‹çš„ç›¸å¯¹ä½ç½®å’ŒçœŸå®ç›¸å¯¹ä½ç½®ä¹‹é—´çš„å·®åˆ«ï¼Œä½¿ç”¨æ¬§å‡ é‡Œå¾—è·ç¦»æ¥è¿›è¡Œè®¡ç®—ã€‚å¦‚æœe_i_jæ¯”è¾ƒå°ï¼Œé‚£ä¹ˆé¢„æµ‹çš„token i å’Œ j ä¹‹é—´çš„å…³ç³»å’ŒçœŸå®çš„token i å’Œ j ä¹‹é—´çš„å…³ç³»å¯¹é½çš„å¥½ï¼Œå¦åˆ™å¯¹é½çš„å·®ã€‚
                    - æ³¨æ„ï¼Œè¿™é‡Œçš„(i,j)æ˜¯ä¸å¯äº¤æ¢çš„ï¼Œe_i_jå’Œe_j_iæ˜¯ä¸åŒçš„ã€‚
        - PAE Loss è®¡ç®—æµç¨‹ï¼š
            - é€šè¿‡confidence headè®¡ç®—å¾—åˆ°çš„ $\mathbf{p}\_{ij}^{\text{pae}}$ ä¸º b_pae=64 ç»´åº¦çš„å‘é‡ï¼Œè¡¨ç¤ºe_i_j è½åˆ°64ä¸ªbinï¼ˆä»0åŸƒåˆ°32åŸƒï¼Œæ¯0.5åŸƒä¸€ä¸ªé˜¶æ¢¯ï¼‰ä¸­çš„æ¦‚ç‡ã€‚
            - ä¸ºäº†ä½¿å¾— $\mathbf{p}\_{ij}^{\text{pae}}$ çš„åˆ†å¸ƒæ›´åŠ æ¥è¿‘äºå®é™…çš„ e_i_j çš„å€¼ï¼Œé‡‡ç”¨äº¤å‰ç†µçš„losså‡½æ•°æ¥å¯¹é½äºŒè€…ï¼Œä½¿å¾— $\mathbf{p}\_{ij}^{\text{pae}}$ èƒ½å¤Ÿæ›´å¥½åœ°é¢„æµ‹å®é™…çš„e_i_jçš„å€¼ã€‚ï¼ˆæ³¨æ„ï¼šè¿™é‡Œlossçš„è®¾è®¡ä¸æ˜¯æœ€å°åŒ–e_i_jçš„å€¼ï¼Œé‚£å¯èƒ½æ˜¯ä¸ºäº†è·å¾—æ›´å¥½çš„ç»“æ„é¢„æµ‹ç²¾åº¦ï¼›è€Œæ˜¯é€šè¿‡äº¤å‰ç†µlossæ¥æ›´å¥½çš„è®©é¢„æµ‹çš„æ¦‚ç‡ $\mathbf{p}\_{ij}^{\text{pae}}$ å’Œe_i_jçš„ç»“æœæ›´åŠ çš„æ¥è¿‘ï¼Œä»è€Œæ›´å¥½åœ°é¢„æµ‹e_i_jçš„å¤§å°ï¼›e_i_jè¶Šå¤§è¡¨æ˜æ¨¡å‹è®¤ä¸ºè¿™ä¸¤ä¸ªä½ç½®çš„ç›¸å¯¹æ„è±¡å­˜åœ¨è¾ƒå¤§çš„ä¸ç¡®å®šæ€§ï¼Œe_i_jè¶Šå°æ„å‘³ç€å¯¹äºé‚£ä¸¤ä¸ªä½ç½®çš„ç›¸å¯¹æ„æƒ³æ›´æœ‰ä¿¡å¿ƒï¼‰
            - æ‰€ä»¥æœ€ç»ˆPAEçš„losså®šä¹‰ä¸ºï¼šï¼ˆæ³¨æ„è¿™é‡Œçš„e_b_i_jå’Œå‰é¢çš„e_i_jä¸åŒï¼Œå¦‚æœe_i_jè½åœ¨å¯¹åº”çš„bin bï¼Œåˆ™è¿™ä¸ªå¯¹åº”çš„e_b_i_jæ˜¯1ï¼Œå¦åˆ™e_b_i_jæ˜¯0ï¼‰
                
                ![image.png](images/image%2079.png)
                
        - å¦‚æœåœ¨é¢„æµ‹ä¸­è¦è®¡ç®—PAE_i_jçš„å€¼ï¼Œåˆ™é€šè¿‡æ±‚æœŸæœ›çš„æ–¹å¼æ¥è¿›è¡Œè®¡ç®—ã€‚
            - æŠŠ64ä¸ªç¦»æ•£çš„binå–å…¶åŒºé—´çš„ä¸­å¿ƒå€¼ï¼Œç„¶åæŒ‰ç…§ä½ç½®ä¹˜ä»¥æ¯ä¸€ä¸ªä½ç½®çš„é¢„æµ‹æ¦‚ç‡ p_b_i_jï¼ˆå³e_i_jçš„å€¼è½åœ¨è¿™ä¸ªbinä¸­çš„æ¦‚ç‡ï¼‰ï¼Œå°±å¾—åˆ°äº†å¯¹äºe_i_jçš„ä¸€ä¸ªæœŸæœ›çš„å€¼ï¼š
                
                ![image.png](images/image%2080.png)
                
    - Predicted Distance Error(PDE)ï¼štokenå¯¹ä¹‹é—´ä»£è¡¨åŸå­ç»å¯¹è·ç¦»çš„ç½®ä¿¡åº¦é¢„æµ‹ã€‚
        - é™¤äº†å¯¹é½è¯¯å·®ï¼Œæ¨¡å‹åŒæ ·ä¹Ÿéœ€è¦é¢„æµ‹é‡è¦åŸå­ä¹‹é—´çš„ç»å¯¹è·ç¦»çš„é¢„æµ‹è¯¯å·®ã€‚
        - è¿™é‡Œçš„distance errorçš„è®¡ç®—æ–¹å¼æ¯”è¾ƒç®€å•ï¼Œå¦‚ä¸‹ï¼š
            - é¦–å…ˆï¼Œè®¡ç®—æ¨¡å‹é¢„æµ‹çš„ token i å’Œtoken jçš„ä»£è¡¨æ€§åŸå­ä¹‹é—´çš„ç»å¯¹è·ç¦»ï¼š $d\_{ij}^{\text{pred}}$
            - ç„¶åï¼Œè®¡ç®—æ¨¡å‹çš„çœŸå®çš„ token i å’Œ token j çš„ä»£è¡¨æ€§åŸå­ä¹‹é—´çš„ç»å¯¹è·ç¦»ï¼š $d\_{ij}^{\text{gt}}$
            - æœ€åï¼Œç›´æ¥è®¡ç®—äºŒè€…çš„ç»å¯¹å·®å¼‚ï¼š $e\_{ij} = \left| d\_{ij}^{\text{pred}} - d\_{ij}^{\text{gt}} \right|$
        - ç±»ä¼¼çš„ï¼Œé€šè¿‡confidence headé¢„æµ‹å‡º $\mathbf{p}\_{ij}^{\text{pae}}$ çš„ç»“æœä¹ŸåŒæ ·æ˜¯64ç»´çš„å‘é‡ï¼Œè¡¨ç¤ºe_i_j è½åˆ°64ä¸ªbinï¼ˆä»0åŸƒåˆ°32åŸƒï¼Œæ¯0.5åŸƒä¸€ä¸ªé˜¶æ¢¯ï¼‰ä¸­çš„æ¦‚ç‡ã€‚
        - ç±»ä¼¼çš„ï¼Œç„¶åé€šè¿‡äº¤å‰ç†µlossæ¥å¯¹é½äºŒè€…ï¼Œå¾—åˆ°L_pde:
            
            ![image.png](images/image%2081.png)
            
        - ç±»ä¼¼çš„ï¼Œåœ¨é¢„æµ‹ä¸­ï¼Œä½¿ç”¨æ±‚æœŸæœ›çš„æ–¹å¼æ¥æ±‚ä¸€ä¸ªtoken-pairçš„pdeå€¼ï¼šï¼ˆ$\Delta_b$æ˜¯åŒºé—´ä¸­å¿ƒå€¼ï¼‰
            
            ![image.png](images/image%2082.png)
            
    - Experimentally Resolved Predictionï¼šé¢„æµ‹ä¸€ä¸ªåŸå­æ˜¯å¦èƒ½å¤Ÿè¢«å®éªŒè§‚æµ‹åˆ°
        - è¿™ä¸ªæ˜¯ä¸€ä¸ªåºå·ä¸ºåŸå­åºå·lçš„é¢„æµ‹ç½®ä¿¡åº¦å€¼ï¼Œç”¨äºè¡¨ç¤ºå½“å‰åŸå­læ˜¯å¦èƒ½å¤Ÿæ­£ç¡®åœ°è¢«å®éªŒè§‚æµ‹åˆ°ã€‚
        - y_l æŒ‡çš„æ˜¯å½“å‰çš„åŸå­æ˜¯å¦æ­£ç¡®è¢«å®éªŒè§£æï¼Œæ˜¯ä¸€ä¸ª2ç»´çš„0/1å€¼ï¼›p_læ˜¯ä¸€ä¸ªä»confidence headå‡ºæ¥çš„2ç»´å‘é‡ï¼Œæ˜¯ä¸€ä¸ªsoftmaxçš„ç»“æœï¼Œä»£è¡¨æ¨¡å‹é¢„æµ‹å½“å‰låŸå­æ˜¯å¦è¢«æ­£ç¡®è§£æã€‚
        - æœ€ç»ˆçš„ä¼˜åŒ–ç›®æ ‡æ˜¯é¢„æµ‹å‡ºå½“å‰åŸå­æ˜¯å¦èƒ½å¤Ÿè¢«å®éªŒæ­£ç¡®è§£æï¼Œæ‰€ä»¥losså‡½æ•°æ˜¯ï¼š
            
            ![image.png](images/image%2083.png)
            
- Confidence Head çš„è®¡ç®—ï¼šConfidence Headçš„ç›®æ ‡åœ¨äºåŸºäºå‰é¢æ¨¡å‹çš„è¡¨å¾å’Œé¢„æµ‹ï¼Œè¿›ä¸€æ­¥ç”Ÿæˆä¸€ç³»åˆ—çš„ç½®ä¿¡åº¦åˆ†å¸ƒï¼ˆpLDDT, PAE, PDE, resolved ç­‰çš„ç½®ä¿¡åº¦åˆ†å¸ƒï¼‰ï¼Œå¹¶å¯ä»¥ç”¨äºåç»­confidence lossçš„è®¡ç®—ï¼ˆæˆ–è€…ç›´æ¥ç”¨äºæ¨¡å‹çš„è¾“å‡ºé¢„æµ‹ï¼‰
    - Confidence Headçš„è¾“å…¥ï¼š
        - æ¥è‡ªæœ€åˆInputFeatureEmbedderçš„token-level single embedding ç‰¹å¾ {s_inputs_i}ã€‚
        - æ¥è‡ªä¸»å¹²ç½‘ç»œçš„token-level single embedding {s_i} å’Œ token-level pair embedding {z_i_j} ã€‚
        - æ¥è‡ªdiffusion moduleçš„mini-rollouté¢„æµ‹ç»“æ„ï¼š {x_pred_l}ã€‚
    - ç®—æ³•è®¡ç®—è¿‡ç¨‹è§£æï¼š
        
        ![image.png](images/image%2084.png)
        
        1. å¯¹token-level pair embedding z_i_jè¿›è¡Œæ›´æ–°ï¼ŒåŠ å…¥äº†ä»åˆå§‹çš„ single embeddingæŠ•å½±è¿‡æ¥çš„ä¿¡æ¯ã€‚
        2. è®¡ç®—æ¨¡å‹é¢„æµ‹å‡ºçš„token iå’Œtoken jçš„ä»£è¡¨æ€§åŸå­ï¼ˆåŸå­åºå·ä¸ºl_rep(i))çš„ä¸‰ç»´åæ ‡ä¹‹é—´çš„è·ç¦»ï¼Œæ ‡è¯†ä¸ºd_i_jã€‚
        3. æŠŠd_i_jçš„å€¼ç¦»æ•£åˆ°v_binså®šä¹‰çš„åŒºé—´ä¸Šï¼Œè®¡ç®—å‡ºå…¶one-hotçš„è¡¨å¾ï¼Œç„¶åç»è¿‡ä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œæ›´æ–°åˆ°token-level pair embeddingä¸Šé¢ã€‚
        4. ç»§ç»­è®©token-levelçš„å•ä½“è¡¨å¾{s_i}å’Œé…å¯¹è¡¨å¾{z_i_j}è¿›è¡ŒPairformerçš„æ›´æ–°ï¼Œç›¸å½“äºå†è®©è¿™ä¸¤ç±»è¡¨å¾ç›¸äº’äº¤äº’å¼ºåŒ–å‡ è½®ï¼Œå¾—åˆ°æœ€ç»ˆçš„{s_i}å’Œ{z_i_j}ã€‚
        5. è®¡ç®—PAEçš„ç½®ä¿¡åº¦æ¦‚ç‡ï¼Œå…¶æœ€ç»ˆçš„ç»“æœæ˜¯ä¸€ä¸ªb_pae=64ç»´åº¦çš„å‘é‡ã€‚å› ä¸ºPAEå®é™…ä¸Šä¹Ÿæ˜¯token-tokençš„è¡¨å¾ï¼ˆè™½ç„¶å®é™…ä¸Šè®¡ç®—çš„æ˜¯ä»£è¡¨åŸå­å’Œframeä¹‹é—´çš„è·ç¦»ï¼‰ï¼Œæ‰€ä»¥ä½¿ç”¨{z_i_j}è¿›è¡Œçº¿æ€§å˜æ¢ä¹‹åç›´æ¥æ±‚softmaxæ¥è·å–è¿™ä¸ªç½®ä¿¡åº¦æ¦‚ç‡ï¼Œä»£è¡¨çš„æ˜¯å…¶PAEçš„å€¼è½åœ¨64ä¸ªåŒºé—´ä¸­æ¯ä¸ªåŒºé—´çš„æ¦‚ç‡ã€‚ï¼ˆæ³¨æ„ï¼šè¿™é‡Œiå’Œjæ˜¯ä¸å¯äº¤æ¢çš„ï¼‰
        6. è®¡ç®—PDEçš„ç½®ä¿¡åº¦æ¦‚ç‡ï¼Œå…¶æœ€ç»ˆçš„ç»“æœæ˜¯ä¸€ä¸ªb_pde=64ç»´åº¦çš„å‘é‡ã€‚åŒç†ï¼ŒPDEä¹Ÿæ˜¯token-tokençš„è¡¨å¾ï¼ˆå®é™…ä¸Šè®¡ç®—çš„æ˜¯ä»£è¡¨åŸå­ä¹‹é—´çš„ç»å¯¹è·ç¦»ï¼‰ï¼Œä½¿ç”¨z_i_jå’Œz_j_içš„ä¿¡æ¯è¿›è¡Œèåˆï¼Œç„¶åçº¿æ€§å˜æ¢å¹¶ç›´æ¥æ±‚softmaxæ¥è·å–ç½®ä¿¡åº¦æ¦‚ç‡ï¼Œä»£è¡¨çš„æ˜¯PDEçš„å€¼è½åœ¨64ä¸ªåŒºé—´ä¸­æ¯ä¸ªåŒºé—´çš„æ¦‚ç‡ã€‚ï¼ˆæ³¨æ„ï¼šè¿™é‡Œçš„iå’Œjæ˜¯å¯äº¤æ¢çš„ï¼‰
        7. è®¡ç®—pLDDTçš„ç½®ä¿¡åº¦æ¦‚ç‡ï¼ˆæ³¨æ„ï¼šè¿™é‡Œçš„pLDDTçš„ç½®ä¿¡åº¦æ¦‚ç‡æ˜¯æ¯ä¸€ä¸ªåŸå­çš„å€¼ï¼Œæ˜¯ä»¥åŸå­åºå·lè€Œä¸æ˜¯tokenåºå·iæ¥è¿›è¡Œç´¢å¼•çš„ã€‚ï¼‰
            1. è¿™é‡Œs_i(l)ä»£è¡¨çš„å«ä¹‰æ˜¯ï¼šè·å–åŸå­læ‰€å¯¹åº”çš„token i å¯¹åº”çš„é‚£ä¸ªtoken-level single embedding.
            2. è¿™é‡Œçš„LinearNoBias_token_atom_idx(l)( â€¦ ) ï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯ï¼Œé’ˆå¯¹ä¸åŒçš„åŸå­lï¼Œå…¶å¯¹åº”çš„ç”¨äºçº¿æ€§å˜æ¢çš„çŸ©é˜µæ˜¯ä¸åŒçš„ï¼Œé€šè¿‡token_atom_idx(l)æ¥è·å–å¯¹åº”çš„weightçŸ©é˜µï¼ŒçŸ©é˜µå½¢çŠ¶ä¸º[c_token, b_plddt] ï¼Œç„¶åå°†å…¶å³ä¹˜s_i(l)ï¼Œå½¢çŠ¶æ˜¯[c_token]å¾—åˆ°æœ€ç»ˆçš„å‘é‡ä¸º[b_plddt]ã€‚
            3. æœ€åå†è¿›è¡Œsoftmaxæ¥å¾—åˆ°pLDDTçš„ç½®ä¿¡åº¦æ¦‚ç‡ï¼Œå…¶b_plddt=50ï¼Œæ˜¯ä¸€ä¸ª50ç»´åº¦çš„å‘é‡ï¼Œæ ‡è¯†lddtçš„å€¼è½åˆ°è¿™ä¸ª50ä¸ªbinèŒƒå›´å†…çš„æ¦‚ç‡ã€‚
        8. è®¡ç®—resolvedçš„ç½®ä¿¡åº¦æ¦‚ç‡ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œçš„resolvedçš„ç½®ä¿¡åº¦æ¦‚ç‡ä¹Ÿæ˜¯é’ˆå¯¹æ¯ä¸€ä¸ªåŸå­çš„å€¼ï¼ŒåŒä¸Šï¼‰ï¼šè®¡ç®—çš„ç»“æœç»è¿‡softmaxä¹‹åæ˜¯ä¸€ä¸ª2ç»´çš„å‘é‡ï¼Œé¢„æµ‹å½“å‰åŸå­æ˜¯å¦èƒ½å¤Ÿè¢«å®éªŒè§£æå‡ºæ¥çš„ç½®ä¿¡åº¦ã€‚

---

# ğŸ“¬ è”ç³»ä¸åˆä½œ

**ä½œè€…**: Yichong Shen  
**é‚®ç®±**: shenyichong2011@gmail.com  
**GitHub**: [@shenyichong](https://github.com/shenyichong)

å¦‚æœæ‚¨å¯¹è¿™ä»½AlphaFold 3åˆ†ææœ‰ä»»ä½•é—®é¢˜ã€è®¨è®ºæˆ–æ½œåœ¨åˆä½œæ„å‘ï¼Œè¯·éšæ—¶é€šè¿‡é‚®ç®±è”ç³»æˆ–åœ¨æœ¬ä»“åº“ä¸­åˆ›å»ºissueã€‚

# ğŸŒŸ æ”¯æŒè¿™é¡¹å·¥ä½œ

å¦‚æœè¿™ä»½å…¨é¢çš„åˆ†æå¸®åŠ©æ‚¨æ›´å¥½åœ°ç†è§£äº†AlphaFold 3ï¼Œè¯·è€ƒè™‘ï¼š
- â­ **ä¸ºæœ¬ä»“åº“ç‚¹æ˜Ÿ** å¸®åŠ©å…¶ä»–äººå‘ç°å®ƒ
- ğŸ”„ **åˆ†äº«** ç»™æ‚¨çš„åŒäº‹å’Œç½‘ç»œ
- ğŸ’­ **åˆ›å»ºissues** æå‡ºé—®é¢˜æˆ–å»ºè®®  
- ğŸ¤ **è´¡çŒ®** é€šè¿‡pull requestæä¾›æ”¹è¿›æˆ–ä¿®æ­£

---